(function(){var __webpack_modules__={323:function(e,t,a){"use strict";function o(e){const t=document.createElement("canvas");t.width=e[0],t.height=e[1];const a=t.getContext("2d",{alpha:!0});if(!a)throw new Error("failed to acquire context");return[t,a]}a.d(t,{wA:function(){return o}})},355:function(e,t,a){"use strict";Date.now();console.log.bind(console)},577:function(e,t,a){"use strict";a.d(t,{Y:function(){return i}});var o=a(542),n=a(322);const s={},l={};function i(e,t){let a;t=JSON.parse(JSON.stringify(t));try{a=localStorage.getItem(e)}catch(u){console.warn("LocalStorage get failed"),console.error(u)}let i=t;if(null!=a)try{i=JSON.parse(a)}catch(u){console.warn("LocalStorage JSON Parse failed"),console.error(u)}const r=(0,o.iH)(i);return(0,n.m0)((()=>{const t=r.value;let a;try{a=JSON.stringify(t)}catch(u){return console.warn("JSON stringify failed"),console.error(u),null}try{localStorage.setItem(e,a)}catch(u){return console.warn("LocalStorage set failed"),console.error(u),null}})),s[e]=r,l[e]=JSON.parse(JSON.stringify(t)),r}},349:function(e,t,a){"use strict";var o=a(728),n=a(322);function s(e,t,a,o,s,l){const i=(0,n.up)("GameViewer2"),r=(0,n.up)("GameViewer");return 1==e.gameViewer2PreviewMode?((0,n.wg)(),(0,n.j4)(i,{key:0})):((0,n.wg)(),(0,n.j4)(r,{key:1}))}var l=a(682);function i(e,t,a,o,s,i){return(0,n.wg)(),(0,n.iD)("div",null,[t[0]||(t[0]=(0,n.Uk)(" Configurator ")),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.pages,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e},[(0,n._)("pre",null,(0,l.zw)(JSON.stringify(e,null,2)),1)])))),128))])}var r=(0,n.aZ)({name:"Configurator",props:{},data:()=>({pages:[{type:"OnboardingPage",welcomeMessage:"hi world",alignment:"right"},{type:"MixAndMatchPage"}]})}),u=a(599);const c=(0,u.Z)(r,[["render",i]]);var d=c;function _(e,t,a,o,s,i){const r=(0,n.up)("AssetFolder");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Uk)((0,l.zw)(e.msg)+" ",1),(0,n._)("button",{onClick:t[0]||(t[0]=(...t)=>e.moo&&e.moo(...t))},"moo"),(0,n.Wm)(r,{path:"",dirStructure:e.dirStructure},null,8,["dirStructure"])])}const g={key:0},p={key:0},m=["src"],h={key:1},v={class:"indent"};function w(e,t,a,o,s,i){const r=(0,n.up)("AssetFolder",!0);return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Uk)(" Asset Folder "+(0,l.zw)(e.path)+" "+(0,l.zw)(JSON.stringify(e.dirStructure))+" ",1),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Object.entries(e.dirStructure),(([a,o])=>((0,n.wg)(),(0,n.iD)("div",{key:o},[o.constructor===Number?((0,n.wg)(),(0,n.iD)("span",g,[a.endsWith(".png")||a.endsWith(".jpg")?((0,n.wg)(),(0,n.iD)("div",p,[(0,n._)("img",{src:"/sge/vault/"+e.path+"/"+a},null,8,m)])):(0,n.kq)("",!0),(0,n.Uk)(" "+(0,l.zw)(a)+" : "+(0,l.zw)(o),1)])):((0,n.wg)(),(0,n.iD)("span",h,[(0,n._)("b",null,(0,l.zw)(a),1),t[0]||(t[0]=(0,n._)("br",null,null,-1)),(0,n._)("div",v,[(0,n.Uk)((0,l.zw)(JSON.stringify(o))+" ",1),(0,n.Wm)(r,{path:e.path+"/"+a,dirStructure:o},null,8,["path","dirStructure"])])]))])))),128))])}var f=(0,n.aZ)({name:"AssetFolder",props:{dirStructure:{default:()=>({})},path:{default:""}},data:()=>({})});const y=(0,u.Z)(f,[["render",w],["__scopeId","data-v-e541457e"]]);var E=y;const P="sge";async function b(e,t){try{var a=await fetch(`/${P}/api/`+e,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)});return await a.json()}catch(o){return void console.warn(o?.body?.error?.stack.split("\n    at Object.callWith (")[0])}}var M=(0,n.aZ)({name:"HelloWorld",components:{AssetFolder:E},props:{msg:String},data:()=>({dirStructure:{}}),methods:{async moo(){let e=await b("getVaultListing",{});this.dirStructure=e}}});const D=(0,u.Z)(M,[["render",_],["__scopeId","data-v-284370ed"]]);var k=D;const O={key:0,class:"loading"},U={key:1,id:"lottie-loading"},I={key:2,class:"loading"},T=["onClick"],x=["title","onClick"],C=["onClick","id"],W={key:0,class:"scratchpad-empty"},L=["href","title"],S={key:4,class:"game-display"},A={key:0,class:"mobile-page"},B={key:5,class:"grid-display"},R={style:{opacity:"0.01",height:"1px",position:"absolute",top:"0px"}},V=["href","title"];function H(e,t,a,s,i,r){const u=(0,n.up)("Lottie"),c=(0,n.up)("LoadingBar"),d=(0,n.up)("DebugPanel");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("div",{class:(0,l.C_)(e.debugMode?"debug":"live")},[e.problems.length?((0,n.wg)(),(0,n.iD)("div",O,(0,l.zw)(e.problems.join(", ")),1)):(0,n.kq)("",!0),e.loading&&e.game&&e.game.loadingAnimation?((0,n.wg)(),(0,n.iD)("div",U,[(0,n.Wm)(u,{path:"./vault/"+e.gameName+"/"+e.game.loadingAnimation,class:"slab center top-50 lottie",style:{top:"50%"},loop:"true"},null,8,["path"])])):(0,n.kq)("",!0),!e.loading||e.game&&e.game.loadingAnimation||e.problems.length?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",I,[(0,n.Wm)(c,{percent:100*e.preloadCountDone/e.preloadCountTotal},null,8,["percent"])])),e.debugMode&&!e.veryTall?((0,n.wg)(),(0,n.j4)(d,{key:3},{header:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.gameName),1)])),locales:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.locales,((t,a)=>((0,n.wg)(),(0,n.iD)("span",{key:a},[a>0?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Uk)(" - ")],64)):(0,n.kq)("",!0),(0,n._)("span",{onClick:a=>e.localeClick(t),class:(0,l.C_)(e.currentLocale==t?"current-locale":"")},(0,l.zw)(t),11,T)])))),128))])),pages:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.pages,((t,a)=>((0,n.wg)(),(0,n.iD)("div",{key:a,class:(0,l.C_)(e.currentPageIndex==a?"current-page":"")},[(0,n.Uk)((0,l.zw)(a)+" - ",1),(0,n._)("a",{title:t.type,onClick:t=>e.jumpToPage(a)},(0,l.zw)(t.name||t.type),9,x)],2)))),128))])),games:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.gameNames,(t=>((0,n.wg)(),(0,n.iD)("div",{key:t,class:(0,l.C_)(e.gameName==t?"current-game":"")},[(0,n._)("a",{onClick:a=>e.loadGame(t,!0),id:"game-"+t},(0,l.zw)(t),9,C)],2)))),128))])),control:(0,n.w5)((()=>[(0,n._)("div",null,[(0,n.wy)((0,n._)("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=t=>e.auraEnabled=t),id:"auraEnabled"},null,512),[[o.e8,e.auraEnabled]]),t[4]||(t[4]=(0,n._)("label",{class:"form-check-label",for:"auraEnabled"}," aura",-1))]),(0,n._)("div",null,[(0,n.wy)((0,n._)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=t=>e.fixedSize=t),id:"fixedSize"},null,512),[[o.e8,e.fixedSize]]),t[5]||(t[5]=(0,n._)("label",{class:"form-check-label",for:"fixedSize"}," fixedSize",-1))]),(0,n._)("div",null,[(0,n.wy)((0,n._)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=t=>e.showElementsEnabled=t),id:"showElementsEnabled"},null,512),[[o.e8,e.showElementsEnabled]]),t[6]||(t[6]=(0,n._)("label",{class:"form-check-label",for:"showElementsEnabled"}," show elements",-1))]),(0,n._)("div",null,[(0,n.wy)((0,n._)("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=t=>e.simulateSlowLoading=t),id:"simulateSlowLoading"},null,512),[[o.e8,e.simulateSlowLoading]]),t[7]||(t[7]=(0,n._)("label",{class:"form-check-label",for:"simulateSlowLoading"}," simulate slow loading",-1))])])),scratch:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Object.entries(e.scratchPad),(([e,t])=>((0,n.wg)(),(0,n.iD)("div",{key:e},[(0,n.Uk)((0,l.zw)(e)+": ",1),(0,n._)("i",null,(0,l.zw)(t),1)])))),128)),0==Object.keys(e.scratchPad).length?((0,n.wg)(),(0,n.iD)("div",W," scratchpad empty ")):(0,n.kq)("",!0)])),assets:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.loadedImageURLs,(t=>((0,n.wg)(),(0,n.iD)("a",{target:"_blank",href:e.$getAsset(t),title:t,key:t,class:"thumbnail",style:(0,l.j5)({"background-image":"url('"+e.$getAsset(t)+"')"})},null,12,L)))),128))])),bottom:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.gamePageSize),1)])),_:1})):(0,n.kq)("",!0),e.loading||e.gridMode?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",S,[((0,n.wg)(),(0,n.j4)((0,n.LL)(e.contextType),null,{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.pages,((t,a)=>((0,n.wg)(),(0,n.iD)("div",{key:a},[(0,n.Wm)(o.uT,{name:"fade"},{default:(0,n.w5)((()=>[e.currentPageIndex===a?((0,n.wg)(),(0,n.iD)("div",A,[((0,n.wg)(),(0,n.j4)((0,n.LL)(t.type),{config:t,onNextPage:e.nextPage,scratchPad:e.scratchPad,onUpdateScratchPad:e.updateScratchPad,onJumpToPage:e.jumpToPage,onJumpRelative:e.jumpRelative,params:e.pageParams},null,40,["config","onNextPage","scratchPad","onUpdateScratchPad","onJumpToPage","onJumpRelative","params"]))])):(0,n.kq)("",!0)])),_:2},1024)])))),128))])),_:1}))])),!e.loading&&e.gridMode?((0,n.wg)(),(0,n.iD)("div",B,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.pages,((t,a)=>((0,n.wg)(),(0,n.iD)("div",{key:a,class:"grid-item"},[((0,n.wg)(),(0,n.j4)((0,n.LL)(t.type),{config:t,onNextPage:e.nextPage,scratchPad:e.scratchPad,onUpdateScratchPad:e.updateScratchPad,onJumpToPage:e.jumpToPage,onJumpRelative:e.jumpRelative,params:e.pageParams},null,40,["config","onNextPage","scratchPad","onUpdateScratchPad","onJumpToPage","onJumpRelative","params"]))])))),128))])):(0,n.kq)("",!0)],2),(0,n._)("div",R,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.loadedImageURLs,(t=>((0,n.wg)(),(0,n.iD)("a",{target:"_blank",href:e.$getAsset(t),title:t,key:t,class:"thumbnail",style:(0,l.j5)({transform:"scale(0.01)","background-image":"url('"+e.$getAsset(t)+"')"})},null,12,V)))),128))])])}const $={class:"debug-panel"},K={class:"header section"},N={class:"locales section"},z={class:"pages section"},j={class:"games section"},F={class:"control section"},q={class:"scratch section"},Z={class:"assets section"},G={class:"bottom section"};function Y(e,t,a,o,s,l){return(0,n.wg)(),(0,n.iD)("div",$,[(0,n._)("div",K,[(0,n.WI)(e.$slots,"header",{},void 0,!0)]),(0,n._)("div",N,[(0,n.WI)(e.$slots,"locales",{},void 0,!0)]),(0,n._)("div",z,[(0,n.WI)(e.$slots,"pages",{},void 0,!0)]),(0,n._)("div",j,[(0,n.WI)(e.$slots,"games",{},void 0,!0)]),(0,n._)("div",F,[(0,n.WI)(e.$slots,"control",{},void 0,!0)]),(0,n._)("div",q,[(0,n.WI)(e.$slots,"scratch",{},void 0,!0)]),(0,n._)("div",Z,[(0,n.WI)(e.$slots,"assets",{},void 0,!0)]),(0,n._)("div",G,[(0,n.WI)(e.$slots,"bottom",{},void 0,!0)])])}var J=(0,n.aZ)({name:"DebugPanel",data(){return{}},computed:{},methods:{},props:{prop1:{default:""}}});const Q=(0,u.Z)(J,[["render",Y],["__scopeId","data-v-226a6bc3"]]);var X=Q;function ee(e,t,a,o,s,i){return(0,n.wg)(),(0,n.iD)("div",{class:"loading-bar",style:(0,l.j5)(e.style)},null,4)}var te=(0,n.aZ)({name:"LoadingBar",data(){return{}},computed:{style(){return{"box-shadow":"calc(var(--page-width) * 0.5 * 0.01 * "+this.percent+") 0 0 #aaa inset"}}},methods:{},props:{percent:{default:0}}});const ae=(0,u.Z)(te,[["render",ee],["__scopeId","data-v-b54d4cde"]]);var oe=ae;const ne={ref:"lottie-container"};function se(e,t,a,o,s,l){return(0,n.wg)(),(0,n.iD)("div",ne,null,512)}var le=a(845),ie=a.n(le),re=(0,n.aZ)({name:"Lottie",data:()=>({}),methods:{},props:{asset:{default:""},path:{default:""},shadowEnabled:{default:!0},loop:{default:!0}},mounted(){if(this.asset||this.path){let e=this.$refs["lottie-container"],t=this.path||window.$getAssetPath(this.asset);console.log("bodymovin:"),console.log(ie()),ie().loadAnimation({container:e,renderer:"svg",loop:!0===this.loop||"true"===this.loop,autoplay:!0,path:t})}else console.warn("uh oh... Lottie did not receive an :asset")}});const ue=(0,u.Z)(re,[["render",se],["__scopeId","data-v-10ead392"]]);var ce=ue,de={name:"IAM_Mosaic_Oct_fr_CRS",title:"I AM Mosaic October",context:"NewContext",bgColor:"#222",noLegacy:!0,newGameViewer:!0,pages:[{type:"TestLoadingPage",role:"loading"},{type:"IAMLandingPage",Background:"IAMFrance_Mosaic_Game_Background.webp",Button:"IAMFrance_Mosaic_Game_LandingPage-Button.webp",Logo:"IAMFrance_Mosaic_Game_LandingPageHeading.webp",Heading:"IAMFrance_Mosaic_Game_LandingPage-Text.webp",persist:{hey:"",hello:10,pos:[0,-37.15881305833884],size:[29.60000000000001,19.595426246977734],Elements:"",heading:{pos:[0,.09500000000000001],size:[30.81870438868687,29.744251945967157],anchor:"center",asset:"Heading",backgroundMode:"contain"},logo:{pos:[-.01445792887174625,-24.618210780627415],size:[14.100000000000014,9.100000000000003],anchor:"center",asset:"Logo",backgroundMode:"contain"},button:{pos:[0,30],size:[26.288290903407272,6.349999999999998],anchor:"center",asset:"Button",backgroundMode:"contain"}}},{type:"IAMMosaicOnboardingPage",Background:"IAMFrance_Mosaic_Game_Background.webp",Picture:"IAMFrance_Mosaic_Game_OnboardingPage-Boxes.webp",Button:"IAMFrance_Mosaic_Game_OnboardingPage-Button.webp",Text:"IAMFrance_Mosaic_Game_OnboardingPage-Instructions.webp",persist:{Elements:"",picture:{pos:[0,-18.460864447059205],size:[39.253499477093804,35.22068905794852],anchor:"center",asset:"Picture",backgroundMode:"contain"},text:{pos:[.18,11.920038893017658],size:[71.43883514154436,21.919571235229252],anchor:"center",asset:"Text",backgroundMode:"contain"},button:{pos:[0,30],size:[30,10],anchor:"center",asset:"Button",backgroundMode:"contain"}}},{type:"IAMMosaicPage",Text:"IAMFrance_Mosaic_Game_Game-Page-Text.webp",Button:"IAMFrance_Mosaic_Game_Game-Page-Button2.webp",Background:"IAMFrance_Mosaic_Game_Background.webp",Mosiac:"IAMFrance_Mosaic_Game_Mosiac.webp"},{type:"IAMMosaicOutcomePage",Background:"IAMFrance_Mosaic_Game_Background.webp",Picture:"IAMFrance_Mosaic_Game_Outcome-Page-SplashText.webp",Button:"IAMFrance_Mosaic_Game_Outcome-Page-Button.webp",Text:"IAMFrance_Mosaic_Game_Outcome-Page-Text.webp",persist:{Onboarding:"",picture:{pos:[0,.31999999999999984],size:[119.88051738493009,33.57321748313068],anchor:"center",asset:"Picture",backgroundMode:"contain"},text:{pos:[0,-25.03130972431322],size:[33.98814347130618,20],anchor:"center",asset:"Text",backgroundMode:"contain"},button:{pos:[0,30],size:[30,10],anchor:"center",asset:"Button",backgroundMode:"contain"}}},{type:"BlankPage"}],temp:{Background2:"IAMFrance_Mosaic_Game_Background2.webp","Game-Page-Button1":"IAMFrance_Mosaic_Game_Game-Page-Button1.webp","Game-Page-Button2":"IAMFrance_Mosaic_Game_Game-Page-Button2.webp","Game-Page-Text":"IAMFrance_Mosaic_Game_Game-Page-Text.webp"}};const _e={IAM_Mosaic_Oct_fr_CRS:de};var ge=a(708),pe={deploymentName:"testing",commitHash:"54ddeb00",buildNumber:4927,gameName:"IAM_Mosaic_Oct_fr_CRS",newGameViewer:!0},me=a(438),he=a(983),ve=a(287),we=a(598),fe=a(734);class ye{items={};pendingItems={};loadFunc;constructor(e){this.loadFunc=e}async load(e){let t;"string"===typeof e&&(e=[e]);for(const o of e){const n=this.items[o];if(n)return n;const s=this.pendingItems[o];if(s)return await s;t=this.loadFunc(o),this.pendingItems[o]=t;try{this.items[o]=await t}catch(a){throw console.warn(`error loading resource ${e}`),a}delete this.pendingItems[o]}if(t)return t;throw new Error("resource load failed")}get(e){const t=this.getOrNull(e);if(null==t)throw new Error(`${this.constructor.name}: resource not found ${e}`);return t}getOrNull(e){const t=Object.prototype.hasOwnProperty.call(this.items,e)?this.items[e]:null;return null===t&&console.warn(`resource ${e} not found`),t}}function Ee(e,t,a){let o={};o=window.progressRecords=window.progressRecords||o,window.progressRecords[e]={bytesDone:t,totalBytes:a,filename:e}}const Pe={};function be(e){return new Promise(((t,a)=>{const o=(new fe.E).setPath(""),n=`vault/${window.gameName}/${e}`;o.load(n,(function(a){window._gltf=a,a.$subs={},a.$filename=e;for(const e of a.scene.children)if("Object3D"===e.type)for(const t of e.children)if(t.name.indexOf("SCREEN")>-1){const o=t.clone();o.$originalPosition=o.position.clone(),window.poop=o;const n=e.matrix.clone().multiply(t.matrix);o.matrix.copy(n),o.matrixAutoUpdate=!1,a.$subs[e.name+"/"+o.name]=o}t(a)}),(t=>{Ee(e,t.loaded,t.loaded)}),(function(e){a(e)}))}))}class Me extends ye{constructor(){super(be)}getSubObject(e,t){const a=this.get(e);if(!a)return null;const o=a.$subs[t];return o||null}}Pe["gltf"]=new Me;function De(e){return new Promise(((t,a)=>{const o=(new me.dpR).setPath(""),n=`vault/${window.gameName}/${e}`;o.load(n,(function(a){a.wrapS=me.rpg,a.wrapT=me.rpg;const o=.2,n=Math.floor(a.image.width*a.image.height*o);Ee(e,n,n),t(a)}),(t=>{Ee(e,t.loaded,null)}))}))}class ke extends ye{constructor(){super(De)}}const Oe=Pe["texture"]=new ke;class Ue extends ye{constructor(){super((e=>(0,ge.Wq)(`vault/${window.gameName}/${e}`)))}}Pe["csv"]=new Ue;class Ie extends ye{constructor(){super((e=>(0,ge.Ol)(`vault/${window.gameName}/${e}`)))}}Pe["txt"]=new Ie;async function Te(e){const t=`vault/${window.gameName}/${e}`;return await new Promise((e=>{(new we.I).load(t,(function(t){e(t)}))}))}class xe extends ye{constructor(){super(Te)}loadEnvMap(e,t){const a=this.get(e);if(!a)return null;const o=new me.anP(t),n=o.fromEquirectangular(a),s=n.texture;return t.toneMapping=me.EoG,t.toneMappingExposure=1,t.outputEncoding=me.knz,s}}Pe["exr"]=new xe;async function Ce(e){const t=`vault/${window.gameName}/${e}`;return await new Promise((e=>{(new ve.J).load(t,(function(t){e(t)}))}))}class We extends ye{defaultFont=null;constructor(){super((async e=>{const t=await Ce(e);return this.defaultFont||(this.defaultFont=t),t}))}getDefaultFont(){if(!this.defaultFont)throw new Error("no fonts, can't select default font");return this.defaultFont}}Pe["font"]=new We;class Le{howls={};constructor(){}loadSprites(e,t){const a=`./vault/${window.gameName}/${e}`;return this.howls[e]=new he.Howl({src:[a],sprite:t}),new Promise((t=>{this.howls[e].once("load",t)}))}loadSound(e){const t=`./vault/${window.gameName}/${e}`;return this.howls[e]=new he.Howl({src:[t]}),new Promise((t=>{this.howls[e].once("load",t)}))}play(e,t){this.howls[e]?null!==t?this.howls[e].play(t):this.howls[e].play():console.warn("sound not found "+e)}}new Le;const Se={class:"slab full",style:{background:"black"}};function Ae(e,t){return(0,n.wg)(),(0,n.iD)("div",Se)}const Be={},Re=(0,u.Z)(Be,[["render",Ae],["__scopeId","data-v-05236200"]]);var Ve=Re,He=a(542),$e={__name:"Blat2",props:{asset:{default:""}},emits:["tap"],setup(e,{emit:t}){(0,n.f3)("gameTools"),(0,n.f3)("navTools"),(0,n.f3)("appTools");const a=(0,n.f3)("pageTools"),o=e,s=(0,n.Fl)((()=>o.asset?{"background-image":"url('"+a.getAssetUrl(o.asset)+"')"}:{})),i=t,r=(0,He.iH)(!1);function u(){r.value=!0}let c=0;function d(){r.value=!1;let e=Date.now();e-c<200||(c=e,i("tap"))}return(e,t)=>((0,n.wg)(),(0,n.iD)("div",{onMousedown:u,onMouseup:d,onTouchstart:u,onTouchend:d,class:(0,l.C_)("blat2"),style:(0,l.j5)(s.value)},[(0,n.WI)(e.$slots,"default")],36))}};const Ke=(0,u.Z)($e,[["__scopeId","data-v-8cc479c0"]]);var Ne=Ke;const ze={class:"mobile-page"},je={class:"loading-bar"},Fe={class:"loading-message"};var qe={__name:"TestLoadingPage",setup(e){const t=(0,n.f3)("gameTools"),a=((0,n.f3)("gameTools"),(0,n.f3)("navTools"),(0,n.f3)("appTools"),t.loadingPercent),o=t.loadingMessage;return(e,t)=>((0,n.wg)(),(0,n.iD)("div",ze,[(0,n._)("div",je,[(0,n._)("div",{class:"progress",style:(0,l.j5)({width:"2"*(0,He.SU)(a)+"px"})},null,4)]),(0,n._)("div",Fe,(0,l.zw)((0,He.SU)(o)),1)]))}};const Ze=(0,u.Z)(qe,[["__scopeId","data-v-271ac43d"]]);var Ge=Ze,Ye=(0,n.aZ)({__name:"Hero2",props:{asset:{},y:{},x:{},w:{},h:{},widthByHeight:{type:Boolean,default:!0},xByHeight:{type:Boolean,default:!0},anchor:{default:"center"},pos:{default:"by height"},size:{default:"by height"},backgroundMode:{default:"contain"}},emits:["tap"],setup(e,{emit:t}){(0,n.f3)("gameTools"),(0,n.f3)("navTools"),(0,n.f3)("appTools");const a=(0,n.f3)("pageTools"),o=(0,He.iH)(""),s=e;function i(e,t){return void 0==e?t:"string"==typeof e?parseFloat(e):e}const r=(0,n.Fl)((()=>i(s.x,0))),u=(0,n.Fl)((()=>i(s.y,0))),c=(0,n.Fl)((()=>i(s.w,50))),d=(0,n.Fl)((()=>i(s.h,50))),_={center:{top:"50%",left:"50%"},n:{top:"0%",left:"50%"},nw:{top:"0%",left:"0%"},ne:{top:"0%",right:"0%"},w:{top:"50%",left:"0%"},e:{top:"50%",right:"0%"},sw:{bottom:"0%",left:"0%"},s:{bottom:"0%",left:"50%"},se:{bottom:"0%",right:"0%"}},g=e=>"by height"==s.pos?`var(--h) * 0.01 * ${e}`:`var(--w) * 0.01 * ${e}`,p=e=>"by height"==s.size?`var(--h) * 0.01 * ${e}`:`var(--w) * 0.01 * ${e}`,m=(0,n.Fl)((()=>{const e={..._[s.anchor]},t=g(r.value||0),o=g(u.value||0);e.left&&(e.left=`calc(${e.left} + ${t})`),e.right&&(e.right=`calc(${e.right} - ${t})`),e.top&&(e.top=`calc(${e.top} + ${o})`),e.bottom&&(e.bottom=`calc(${e.bottom} - ${o})`);let n=s.asset?a.getAssetUrl(s.asset||""):"",l={"background-image":n?`url('${n}')`:"","background-size":s.backgroundMode,transform:`translate(${e.right?"+50%":"-50%"}, ${e.bottom?"+50%":"-50%"})`,width:`calc(${p(c.value||0)})`,height:`calc(${p(d.value||0)})`,...e};return l})),h=t,v=(0,He.iH)(!1);function w(){v.value=!0}function f(){v.value=!1,h("tap")}return(e,t)=>((0,n.wg)(),(0,n.iD)("div",{onMousedown:w,onMouseup:f,onTouchstart:w,onTouchend:f,class:(0,l.C_)("blat2 "+o.value),style:(0,l.j5)(m.value)},[(0,n.WI)(e.$slots,"default")],38))}});const Je=(0,u.Z)(Ye,[["__scopeId","data-v-5a8a045f"]]);var Qe=Je;const Xe=150;var et={__name:"Button3",props:{asset:{default:""},toggledAsset:{default:""},cover:{default:!1}},emits:["tap","down","up"],setup(e,{emit:t}){(0,n.f3)("gameTools"),(0,n.f3)("navTools"),(0,n.f3)("appTools");const a=(0,n.f3)("pageTools"),o=e,s=(0,n.Fl)((()=>{let e={};return o.asset&&(e={"background-image":"url('"+a.getAssetUrl(o.asset)+"')"}),i.value&&o.toggledAsset&&(e={"background-image":"url('"+a.getAssetUrl(o.toggledAsset)+"')"}),o.cover&&(e["background-size"]="cover"),e}));let i=(0,He.iH)(!1);const r=t;let u=!1;const c=(0,He.iH)(!1);let d=!0;(0,n.bv)((async()=>{await(0,ge._v)(350),d=!1}));let _=!1;function g(){_=!0,c.value||d||o.selected||(c.value=!0,i.value=!0,m=Date.now(),r("down"))}function p(){c.value||d||_||(m=Date.now(),c.value=!0,i.value=!0,r("down"))}let m=0;async function h(){if(_)return;if(!c.value)return void(i.value=!1);const e=Date.now()-m;e<Xe&&await(0,ge._v)(Xe-e),c.value=!1,u=!0,r("tap"),r("up")}function v(){c.value&&(c.value=!1,i.value=!1)}async function w(){if(!_)return;if(!c.value)return;const e=Date.now()-m;e<Xe&&await(0,ge._v)(Xe-e),c.value=!1,u=!0,r("tap"),r("up")}return(e,t)=>((0,n.wg)(),(0,n.iD)("div",{onMousedown:p,onMouseup:h,onMouseleave:v,onTouchstart:g,onTouchend:w,class:(0,l.C_)("button3 "+(c.value?"pressed":"")),style:(0,l.j5)(s.value)},[(0,n.WI)(e.$slots,"default")],38))}};const tt=(0,u.Z)(et,[["__scopeId","data-v-b7dfe422"]]);var at=tt;const ot={class:"inner2"};var nt={__name:"Background3",props:{asset:{default:""},dim:{default:0}},setup(e){const t=e,a=(0,n.Fl)((()=>({background:`rgba(0,0,0,${t.dim})`}))),o=(0,n.f3)("pageTools"),s=(0,n.Fl)((()=>t.asset?{"background-image":"url('"+o.getAssetUrl(t.asset)+"')"}:{}));return(e,t)=>((0,n.wg)(),(0,n.iD)("div",{class:"background3",style:(0,l.j5)(s.value)},[(0,n._)("div",{class:"dimmer",style:(0,l.j5)(a.value)},null,4),(0,n._)("div",ot,[(0,n.WI)(e.$slots,"default")])],4))}};const st=(0,u.Z)(nt,[["__scopeId","data-v-13f9d9af"]]);var lt=st;function it(){return{pageTools:(0,n.f3)("pageTools",null),appTools:(0,n.f3)("appTools",null),gameTools:(0,n.f3)("gameTools",null),navTools:(0,n.f3)("navTools",null)}}const rt=Symbol("isNotifies"),ut=Symbol("isNotifiable");function ct(){const e=new Set,t=function(t,o){e.add(t);const n=()=>{a(t)};return o&&o(n),n},a=function(t){e.delete(t)},o=function(t){for(const a of e)a(t)};return Object.assign(t,{trigger:o,[rt]:!0,[ut]:!0}),t}const dt="sge";async function _t(e,t){try{const a=await fetch(`/${dt}/admin/api/`+e,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)});return await a.json()}catch(a){try{console.warn(a.body.error.stack.split("\n    at Object.callWith (")[0])}catch(o){console.error(a)}return}}const gt=new Map,pt=(0,He.iH)(0);async function mt(e,t){const a=t.gameName.value,o={gameName:a,pageIndex:t.currentPageIndex.value,updatedPage:e.config.value};await _t("commitPageChanges",o)}const ht=(0,He.iH)({});function vt(e,t){const{pageTools:a}=it();a.config.value.persist||(a.config.value.persist={});let o=t;e in a.config.value.persist&&(o=a.config.value.persist[e]);const s=(0,He.iH)(o);return ht.value[e]=1,(0,n.YP)(s,(t=>{a.config.value.persist[e]=t})),a.config.value.persist[e]=s.value,s}function wt(){const{pageTools:e}=it(),t=e.pageIndex.value;gt.set(t,[])}function ft(){const{pageTools:e}=it();let t=gt.get(e.pageIndex.value);function a(e,a){const o=ct(),n={name:e,type:"button",data:(0,He.iH)(),closure:()=>{o.trigger()}};return a&&o(a),t.push(n),pt.value+=1,o}function o(e,a={size:[20,20],pos:[0,0],anchor:"center",asset:"",backgroundMode:"contain"}){const o=vt(e,a),n={name:e,type:"hero2",data:o};return t.push(n),pt.value+=1,n.data}function n(e){const a={name:e,type:"heading",data:(0,He.iH)("")};t.push(a),pt.value+=1}function s(e,a=0){const o=vt(e,a),n={name:e,type:"number",data:o};return t.push(n),pt.value+=1,n.data}function l(e,a=[0,0]){const o=vt(e,a),n={name:e,type:"v2",data:o};return t.push(n),pt.value+=1,n.data}function i(e,a){const o={name:e,type:"textDisplay",data:a};t.push(o),pt.value+=1}function r(e,a){const o=vt(e,a),n={name:e,type:"asset",data:o};return t.push(n),pt.value+=1,n.data}return t||(t=[],gt.set(e.pageIndex.value,t)),{pts:t,addNumber:s,protoTinkersVersion:pt,addV2:l,addHeading:n,addHero2:o,addButton:a,addTextDisplay:i,addAsset:r}}var yt=(0,n.aZ)({__name:"IAMLandingPage",setup(e){const{navTools:t}=it();async function a(){await(0,ge._v)(300),t.nextPage()}wt();const o=ft();o.addHeading("Landing");const s=o.addHero2("heading",{pos:[0,0],size:[20,20],anchor:"center",asset:"Heading",backgroundMode:"contain"}),l=o.addHero2("logo",{pos:[0,-20],size:[20,20],anchor:"center",asset:"Logo",backgroundMode:"contain"}),i=o.addHero2("button",{pos:[0,30],size:[30,10],anchor:"center",asset:"Button",backgroundMode:"contain"});return(e,t)=>((0,n.wg)(),(0,n.j4)(lt,{asset:"Background"},{default:(0,n.w5)((()=>[(0,n.Wm)(Qe,{x:(0,He.SU)(l).pos[0],y:(0,He.SU)(l).pos[1],w:(0,He.SU)(l).size[0],h:(0,He.SU)(l).size[1],asset:(0,He.SU)(l).asset,anchor:(0,He.SU)(l).anchor},null,8,["x","y","w","h","asset","anchor"]),(0,n.Wm)(Qe,{x:(0,He.SU)(s).pos[0],y:(0,He.SU)(s).pos[1],w:(0,He.SU)(s).size[0],h:(0,He.SU)(s).size[1],asset:(0,He.SU)(s).asset,anchor:(0,He.SU)(s).anchor},null,8,["x","y","w","h","asset","anchor"]),(0,n.Wm)(Qe,{x:(0,He.SU)(i).pos[0],y:(0,He.SU)(i).pos[1],w:(0,He.SU)(i).size[0],h:(0,He.SU)(i).size[1],anchor:(0,He.SU)(i).anchor},{default:(0,n.w5)((()=>[(0,n.Wm)(at,{class:"slab full",onTap:a,asset:(0,He.SU)(i).asset},null,8,["asset"])])),_:1},8,["x","y","w","h","anchor"])])),_:1}))}});const Et=(0,u.Z)(yt,[["__scopeId","data-v-741c3d82"]]);var Pt=Et;const bt={class:"container"},Mt={key:0,class:"flash"};function Dt(e,t,a,o,s,l){return(0,n.wg)(),(0,n.iD)("div",bt,[e.flashing?((0,n.wg)(),(0,n.iD)("div",Mt)):(0,n.kq)("",!0)])}function kt(e){return e instanceof MouseEvent?[e.clientX,e.clientY]:[e.changedTouches[0].clientX,e.changedTouches[0].clientY]}window.$getAssetPath=e=>{let t=window._page_config[e];return t||(console.warn(`path ${e} not found in ${window.gameName} config. Include it in def.mjs. Using placeholder.png instead.`),console.warn(JSON.stringify(Object.keys(window._page_config))),t="placeholder.png"),`vault/${window.gameName}/${t}`},window.$getAssetUrl=e=>{let t=window._page_config[e];return t||(console.warn(`path ${e} not found in ${window.gameName} config. Include it in def.mjs. Using placeholder.png instead.`),console.warn(JSON.stringify(Object.keys(window._page_config))),t="placeholder.png"),window.$getAssetPath(e)};const Ot={components:{},props:{},computed:{mixinWorking(){return"mixin is working"}},data:()=>({mouseIsDown:!1,mouseDownCoords:[0,0],lastMouseCoords:[0,0],totalDelta:[0,0],delta:[0,0]}),methods:{resize(){},mouseDown(e){},dragStart(e){},dragMove(e,t,a){},dragEnd(e,t){},mouseUp(e){},getCSSVar(e){return this.$el?getComputedStyle(this.$el).getPropertyValue("--"+e):"no $el"}},mounted(){this.$mouseDownHandler=e=>{let t=(0,ge.Iv)(this.$el),a=[t[0],t[1]];t[2],t[3];this.mouseDownCoords=(0,ge.Q0)(kt(e),a),this.lastMouseCoords=this.mouseDownCoords,this.mouseIsDown||(this.mouseIsDown=!0,this.dragStart(this.mouseDownCoords,e),this.mouseDown(this.mouseDownCoords,e))},this.$el.addEventListener("mousedown",this.$mouseDownHandler),this.$el.addEventListener("touchstart",this.$mouseDownHandler);const e=()=>{this.$el.removeEventListener("mousedown",this.$mouseDownHandler),this.$el.removeEventListener("touchstart",e)};this.$el.addEventListener("touchstart",e),this.$mouseMoveHandler=e=>{if(this.mouseIsDown)if(e instanceof MouseEvent&&0===(1&e.buttons));else{let t=(0,ge.Iv)(this.$el),a=[t[0],t[1]];const o=(0,ge.Q0)(kt(e),a);let n=(0,ge.Q0)(o,this.lastMouseCoords);this.delta=n;let s=(0,ge.Q0)(o,this.mouseDownCoords);this.totalDelta=s,this.dragMove(o,n,s,e),this.lastMouseCoords=o}},this.$el.addEventListener("mousemove",this.$mouseMoveHandler),this.$el.addEventListener("touchmove",this.$mouseMoveHandler),this.$mouseUpHandler=e=>{let t=(0,ge.Iv)(this.$el),a=[t[0],t[1]];const o=(0,ge.Q0)(kt(e),a);if(this.mouseIsDown){let t=(0,ge.Q0)(o,this.mouseDownCoords);this.mouseIsDown=!1,this.dragEnd(o,t,e)}this.mouseUp(o,e)},window.addEventListener("mouseup",this.$mouseUpHandler),window.addEventListener("touchend",this.$mouseUpHandler)},unmounted(){window.removeEventListener("resize",this.resizeHandler)}};Date.now();var Ut=(0,n.aZ)({name:"Flash",mixins:[Ot],components:{},props:{flash:{default:!1}},computed:{},data:()=>({flashing:!1}),methods:{},watch:{async flash(){this.flash&&(this.flashing||(this.flashing=!0,await(0,ge._v)(500),this.flashing=!1))}},mounted(){}});const It=(0,u.Z)(Ut,[["render",Dt],["__scopeId","data-v-54b300da"]]);var Tt=It;function xt(e,t){const a=e.indexOf(t);return a>-1&&e.splice(a,1),e}class Ct{handlers={};on(e,t){(this.handlers[e]=this.handlers[e]||[]).push(t)}off(e,t){xt(this.handlers[e]||[],t)}emit(e,...t){return!!this.handlers[e]&&(this.handlers[e].forEach((e=>e(...t))),!0)}}me.Kj0;me.Kj0;me.Kj0;me.Kj0;me.Tme;me.Tme;a(128);me.Tme;class Wt extends me.Tme{addQueue=[];queueAdd(e){this.addQueue.push(e)}addQueued(){for(const e of this.addQueue)this.add(e);this.addQueue=[]}removeQueue=[];queueRemove(e){this.removeQueue.push(e)}removeQueued(){for(const e of this.removeQueue)e.removeFromParent();this.removeQueue=[]}animChildren(e){for(const t of[...this.children])"anim"in t&&t.anim(e)}anim(e){this.animChildren(e),this.addQueued(),this.removeQueued()}}class Lt extends Wt{game;constructor(e){super(),this.game=e}}me.Tme;class St{scene;camera;engine=null;constructor(){this.scene=new me.xsS,this.camera=new me.cPb(70,this.getAspect(),.01,1e3),this.camera.position.set(0,0,10),this.scene.add(this.camera)}getAspect(){return this.engine?this.engine.getAspect():1}resize(){this.camera instanceof me.cPb&&(this.camera.aspect=this.getAspect(),this.camera.updateProjectionMatrix())}async preload(){}async build(){}animChildren(e){for(const t of[...this.scene.children])"anim"in t&&t.anim(e)}anim(e){}}const At=100;class Bt extends Ct{parent;page;renderer;domElement;width;height;resizeHandler;stopping=!1;game=null;t=0;constructor(e,t,a=!1){super(),this.page=t,this.parent=e,this.width=0,this.height=0,this.renderer=new me.CP7({alpha:!1,antialias:!0,powerPreference:"high-performance"}),this.renderer.setPixelRatio(2),this.renderer.setClearColor(7816226,1),this.renderer.shadowMap.enabled=!1,this.renderer.shadowMap.type=me.ntZ,console.log(this.renderer.toneMapping),console.log("setting tonemapping"),this.renderer.toneMapping=me.uL9,console.log(this.renderer.toneMapping),a||(this.renderer.outputEncoding=me.knz),this.renderer.outputColorSpace=me.GUF,this.resizeHandler=()=>{this.resize()},window.addEventListener("resize",this.resizeHandler),this.resize(),e.appendChild(this.renderer.domElement),this.domElement=this.renderer.domElement}resize(){const e=(0,ge.Iv)(this.parent);this.width=e[2],this.height=e[3],this.renderer.setSize(e[2],e[3]),null!=this.game&&this.game.resize()}getAspect(){return this.width/this.height}unmount(){window.removeEventListener("resize",this.resizeHandler)}begin(){this.anim()}setGame(e){this.game=e,e.engine=this,this.resize()}anim(){if(this.stopping)return;const e=At,t=Date.now(),a=.001*Math.min(t-this.t,e);this.t=t,null!=this.game&&(this.game.anim(a),window.renderingPaused||this.renderer.render(this.game.scene,this.game.camera)),requestAnimationFrame((()=>{this.anim()}))}}class Rt extends me.Tme{texture;tileCoords;tileCount;rot=0;targetRot=0;rotSpeed=2.5;tileMesh;rotating=!1;wrong=!0;sc=1;targetSc=1;scSpeed=.2;constructor(e,t,a){super(),this.texture=e,this.tileCoords=t,this.tileCount=a;const o=new me.DvJ(1,1,1,1,1,1),n=o.attributes.uv;for(let i=0;i<n.array.length;i++)i%2==0?n.array[i]=(t[0]+n.array[i])/a[0]:i%2==1&&(n.array[i]=(t[1]+n.array[i])/a[1]);n.needsUpdate=!0;const s=new me.Wid({emissiveMap:e,emissiveIntensity:1,emissive:new me.Ilk(1,1,1)}),l=new me.Kj0(o,s);this.tileMesh=l,this.add(l),this.rot=Math.floor(4*Math.random()),this.targetRot=Math.floor(3*Math.random())+1,this.sc=1-.5*Math.random()}raycast(e,t){const a=[];this.tileMesh.raycast(e,a),a.length>0&&(a[0].object=this,t.push(a[0]))}tap(e){e?this.targetRot-=1:this.targetRot+=1}anim(e){this.wrong;this.rot=(0,ge.Sy)(this.rot,this.targetRot,e*this.rotSpeed),this.rotating=Math.abs(Math.round(this.rot)-this.rot)>1e-5,this.wrong=!0,this.rotating||(this.wrong=(Math.floor(this.rot)+44444)%4!=0),this.wrong?this.targetSc=.9:this.targetSc=1,this.sc=(0,ge.Sy)(this.sc,this.targetSc,e*this.scSpeed),this.tileMesh.scale.set(this.sc,this.sc,this.sc),this.rotation.setFromVector3(new me.Pa4(0,0,this.rot*Math.PI*.5))}}function Vt(e){return e-Math.floor(e)}class Ht extends St{bulletTime=1;world;raycaster=new me.iMs;tileCount=[1,1];gameCompleteCallback=()=>{};constructor(){super(),this.world=new Lt(this),this.scene.add(this.world),this.camera.position.set(0,0,5.15);const e=new me._12(1,1),t=new me.Kj0(e,new me.Wid({transparent:!0,color:new me.Ilk(0,0,0),opacity:.5}));t.position.set(0,0,0),t.scale.set(3.4,3.4,1),this.scene.add(t)}async preload(){await Promise.all([Oe.load("IAMFrance_Mosaic_Game_Mosiac.webp"),Oe.load("IAMFrance_Mosaic_Game_Background.webp")])}async build(){const e=Oe.get("IAMFrance_Mosaic_Game_Background.webp");e.wrapS=me.rpg,e.wrapT=me.rpg,e.repeat.set(1,1),this.scene.background=e}imageIndex=0;nextImageIndex=1;begin(){this.engine?.renderer.setClearColor(1118481,1),this.initGame()}initGame(){const e="IAMFrance_Mosaic_Game_Mosiac.webp",t=Oe.get(e);if(this.world.clear(),t){this.tileCount=[3,3];for(let e=0;e<this.tileCount[0];e++)for(let a=0;a<this.tileCount[1];a++){const o=new Rt(t,[e,a],this.tileCount);o.position.set(e-(this.tileCount[0]-1)/2,a-(this.tileCount[1]-1)/2,0),this.world.add(o)}}}anim(e){this.animChildren(e*this.bulletTime);let t=0;for(const a of this.world.children)if(t+=1,"wrong"in a&&a.wrong)return;t&&this.tapEnabled&&this.gameComplete()}async gameComplete(){this.gameCompleteCallback(),this.tapEnabled=!1}tapEnabled=!0;tap(e){if(!this.tapEnabled)return;if(!this.engine)return;const t=new me.FM8(e[0]/this.engine.width*2-1,-e[1]/this.engine.height*2+1);this.raycaster.setFromCamera(t,this.camera);const a=this.raycaster.intersectObjects(this.world.children,!1);(0,ge.Kq)(a,(e=>e.distance));for(const o of a){if(console.log(o),!o.uv)continue;const e=[Vt(o.uv.x*this.tileCount[0]),Vt(o.uv.y*this.tileCount[1])];console.log(e);const t=o.object;"tap"in t&&o.object.tap(t.position.x<o.point.x);break}}dragStart(e){}dragMove(e){}dragEnd(e){}}var $t=a(862);const Kt=Symbol("isNotifies"),Nt=Symbol("isNotifiable");function zt(){const e=new Set,t=function(t,o){e.add(t);const n=()=>{a(t)};return o&&o(n),n},a=function(t){e.delete(t)},o=function(t){for(const a of e)a(t)};return Object.assign(t,{trigger:o,[Kt]:!0,[Nt]:!0}),t}function jt(e){return[e.pageX,e.pageY]}class Ft{touch;lastTouch;identifier;lastTime;time;deltaTime;pos;pagePos;lastPos;delta=[0,0];startTime;startPos=[0,0];velocity=[0,0];speed=0;totalTravel=0;move;end;pageElement;smoothedVelocity=void 0;constructor(e,t){this.touch=e,this.lastTouch=e,this.identifier=e.identifier,this.startTime=Date.now(),this.lastTime=Date.now(),this.deltaTime=0,this.time=Date.now();const a=jt(e);this.pos=a,this.startPos=a,this.lastPos=a,this.move=zt(),this.end=zt(),this.pageElement=t,t=this.getPageElement(),this.pagePos=t?(0,$t.Q0)(this.pos,(0,$t.QR)(t)):this.pos}getPosRelativeTo(e){if((0,He.dq)(e)&&(e=e.value),e)return(0,$t.Q0)(this.pos,(0,$t.QR)(e))}getPosPercentRelativeTo(e,t){if((0,He.dq)(e)&&(e=e.value),!e)return;const a=(0,$t.pO)(e);return 0==a[0]&&(a[0]=1),0==a[1]&&(a[1]=1),(0,$t.Ky)((0,$t.Lh)((0,$t.Q0)((0,$t.Zz)(this.pos,[0,-(t||0)]),(0,$t.QR)(e)),a),100)}getPageElement(){return(0,He.dq)(this.pageElement)?this.pageElement.value:this.pageElement}age(){return Date.now()-this.startTime}updateTouch(e){this.lastTouch=this.touch,this.touch=e;const t=jt(e);this.delta=[t[0]-this.pos[0],t[1]-this.pos[1]],this.totalTravel+=(0,$t.DG)(this.delta),this.pos=t,this.lastTime=this.time,this.time=Date.now(),this.deltaTime=this.time-this.lastTime,this.time=Date.now(),this.deltaTime=this.time-this.lastTime,this.velocity=(0,$t.Ky)(this.delta,1/(.001*Math.max(1,this.deltaTime))),this.speed=(0,$t.DG)(this.velocity),this.smoothedVelocity?(0,$t.j0)(this.velocity,[0,0])||(this.smoothedVelocity=(0,$t.Wy)(this.smoothedVelocity,this.velocity,.5)):this.smoothedVelocity=this.smoothedVelocity||this.velocity;const a=this.getPageElement();this.pagePos=a?(0,$t.Q0)(this.pos,(0,$t.QR)(a)):this.pos,this.move.trigger(this)}endTouch(e){this.lastTouch=this.touch,this.touch=e;const t=jt(e);this.delta=[t[0]-this.pos[0],t[1]-this.pos[1]],this.totalTravel+=(0,$t.DG)(this.delta),this.pos=t,this.lastTime=this.time,this.time=Date.now(),this.deltaTime=this.time-this.lastTime,this.velocity=(0,$t.Ky)(this.delta,.001*Math.max(1,this.deltaTime)),this.speed=(0,$t.DG)(this.velocity);const a=this.getPageElement();this.pagePos=a?(0,$t.Q0)(this.pos,(0,$t.QR)(a)):this.pos,this.end.trigger(this)}totalDelta(){return(0,$t.Q0)(this.pos,this.startPos)}pretty(){return`<Finger pos=[${this.pos[0]}, ${this.pos[1]}] identifier=${this.identifier} age=${(.001*this.age()).toFixed(2)} totalDelta=${this.totalDelta()} totalTravel=${0|this.totalTravel}}>`}}function qt(e,t){if((0,He.dq)(e))if(void 0!==e.value)t(e);else{const a=(0,n.YP)(e,(o=>{void 0!==o&&(a(),t(e))}))}else t(e)}function Zt(e,t){let a;a=(0,He.dq)(e)?e:(0,He.iH)(e);const o=zt(),n=zt(),s=zt(),l=zt(),i=zt(),r=()=>{i.trigger()},u=(0,He.iH)({}),c=(0,He.iH)(!1),d=(0,He.iH)(!1);return qt(e,(e=>{const a=e=>{const a=e.changedTouches;for(const n of a){n.identifier in u.value||(u.value[n.identifier]=new Ft(n,t));const a=u.value[n.identifier];a.pageElement=t,o.trigger(a),c.value||e.preventDefault()}};e.value.addEventListener("touchstart",a);const r=e=>{const t=e.changedTouches;for(const a of t){a.identifier in u.value||console.warn(`unknown touch identifier ${a.identifier}`);const t=u.value[a.identifier];t.updateTouch(a),n.trigger(t),c.value||e.preventDefault()}};e.value.addEventListener("touchmove",r);const _=e=>{const t=e.changedTouches;for(const a of t){a.identifier in u.value||console.warn(`unknown touch identifier ${a.identifier}`);const t=u.value[a.identifier];t.endTouch(a),s.trigger(t),c.value||e.preventDefault(),delete u.value[a.identifier]}};e.value.addEventListener("touchend",_),i((()=>{e.value.removeEventListener("touchstart",a),e.value.removeEventListener("touchmove",r),e.value.removeEventListener("touchend",_)}));let g=!1;const p=e=>-1-e.button,m=e=>{e.button>=2||(g=!0,d.value||e.preventDefault(),document.addEventListener("mouseup",v),document.addEventListener("mousemove",h),a({preventDefault(){},changedTouches:[{identifier:p(e),pageX:e.pageX,pageY:e.pageY}]}))},h=e=>{d.value||e.preventDefault(),g&&r({preventDefault(){},changedTouches:Object.values(u.value).filter((e=>e.identifier<0)).map((t=>({identifier:t.identifier,pageX:e.pageX,pageY:e.pageY})))})},v=e=>{d.value||e.preventDefault(),document.removeEventListener("mouseup",v),document.removeEventListener("mousemove",h),g=!1,_({preventDefault(){},changedTouches:[{identifier:p(e),pageX:e.pageX,pageY:e.pageY}]})};function w(e){l.trigger([e.pageX,e.pageY])}e.value.addEventListener("mousedown",m),i((()=>{e.value.removeEventListener("mousedown",m)})),e.value.addEventListener("mousemove",w),i((()=>{e.value.removeEventListener("mousemove",w)})),e.value.addEventListener("contextmenu",(e=>{c.value||e.preventDefault()}))})),{start:o,move:n,end:s,fingers:u,unmount:r,hover:l,noPreventDefaultTouch:c,noPreventDefaultMouse:d}}var Gt=(0,n.aZ)({__name:"IAMMosaicPage",setup(e){(0,n.f3)("pageTools");const{navTools:t}=it();let a=null,o=null;const s=(0,He.iH)(!1),l=(0,He.iH)(!1),i=(0,He.iH)(),r=Zt(i);return r.start((e=>{e.end((()=>{e.totalTravel<20&&a.tap(e.getPosRelativeTo(i))}))})),(0,n.bv)((async()=>{console.log("mounting"),console.log(i.value),o=new Bt(i.value,this,!0),a=new Ht,await a.preload(),await a.build(),o.setGame(a),o.begin(),a.begin(),a.gameCompleteCallback=async()=>{await(0,ge._v)(450),s.value=!0,await(0,ge._v)(103),l.value=!0,s.value=!1,await(0,ge._v)(2e3),t.nextPage()}})),(e,t)=>((0,n.wg)(),(0,n.j4)(lt,{asset:"Background"},{default:(0,n.w5)((()=>[(0,n._)("div",{ref_key:"el",ref:i,style:{position:"absolute",left:"0",top:"0",width:"100%",height:"100%"}},null,512),(0,n.Wm)(Qe,{anchor:"n",y:10,w:40,h:10},{default:(0,n.w5)((()=>[(0,n.Wm)(Ne,{asset:"Text",class:"slab full"})])),_:1}),(0,n.Wm)(Tt,{flash:s.value},null,8,["flash"])])),_:1}))}});const Yt=(0,u.Z)(Gt,[["__scopeId","data-v-e482a738"]]);var Jt=Yt,Qt=(0,n.aZ)({__name:"IAMMosaicOutcomePage",setup(e){const{navTools:t}=it();function a(){window.parent.postMessage("close","*")}wt();const o=ft();o.addHeading("Onboarding");const s=o.addHero2("picture",{pos:[0,0],size:[20,20],anchor:"center",asset:"Picture",backgroundMode:"contain"}),l=o.addHero2("text",{pos:[0,-20],size:[20,20],anchor:"center",asset:"Text",backgroundMode:"contain"}),i=o.addHero2("button",{pos:[0,30],size:[30,10],anchor:"center",asset:"Button",backgroundMode:"contain"});return(e,t)=>((0,n.wg)(),(0,n.j4)(lt,{asset:"Background"},{default:(0,n.w5)((()=>[(0,n.Wm)(Qe,{x:(0,He.SU)(l).pos[0],y:(0,He.SU)(l).pos[1],w:(0,He.SU)(l).size[0],h:(0,He.SU)(l).size[1],asset:(0,He.SU)(l).asset,anchor:(0,He.SU)(l).anchor},null,8,["x","y","w","h","asset","anchor"]),(0,n.Wm)(Qe,{x:(0,He.SU)(s).pos[0],y:(0,He.SU)(s).pos[1],w:(0,He.SU)(s).size[0],h:(0,He.SU)(s).size[1],asset:(0,He.SU)(s).asset,anchor:(0,He.SU)(s).anchor},null,8,["x","y","w","h","asset","anchor"]),(0,n.Wm)(Qe,{x:(0,He.SU)(i).pos[0],y:(0,He.SU)(i).pos[1],w:(0,He.SU)(i).size[0],h:(0,He.SU)(i).size[1],anchor:(0,He.SU)(i).anchor},{default:(0,n.w5)((()=>[(0,n.Wm)(at,{class:"slab full",onTap:a,asset:(0,He.SU)(i).asset},null,8,["asset"])])),_:1},8,["x","y","w","h","anchor"])])),_:1}))}});const Xt=(0,u.Z)(Qt,[["__scopeId","data-v-0647335a"]]);var ea=Xt,ta=(0,n.aZ)({__name:"IAMMosaicOnboardingPage",setup(e){const{navTools:t}=it();async function a(){await(0,ge._v)(300),t.nextPage()}wt();const o=ft();o.addHeading("Onboarding");const s=o.addHero2("picture",{pos:[0,0],size:[20,20],anchor:"center",asset:"Picture",backgroundMode:"contain"}),l=o.addHero2("text",{pos:[0,-20],size:[20,20],anchor:"center",asset:"Text",backgroundMode:"contain"}),i=o.addHero2("button",{pos:[0,30],size:[30,10],anchor:"center",asset:"Button",backgroundMode:"contain"});return(e,t)=>((0,n.wg)(),(0,n.j4)(lt,{asset:"Background"},{default:(0,n.w5)((()=>[(0,n.Wm)(Qe,{x:(0,He.SU)(l).pos[0],y:(0,He.SU)(l).pos[1],w:(0,He.SU)(l).size[0],h:(0,He.SU)(l).size[1],asset:(0,He.SU)(l).asset,anchor:(0,He.SU)(l).anchor},null,8,["x","y","w","h","asset","anchor"]),(0,n.Wm)(Qe,{x:(0,He.SU)(s).pos[0],y:(0,He.SU)(s).pos[1],w:(0,He.SU)(s).size[0],h:(0,He.SU)(s).size[1],asset:(0,He.SU)(s).asset,anchor:(0,He.SU)(s).anchor},null,8,["x","y","w","h","asset","anchor"]),(0,n.Wm)(Qe,{x:(0,He.SU)(i).pos[0],y:(0,He.SU)(i).pos[1],w:(0,He.SU)(i).size[0],h:(0,He.SU)(i).size[1],anchor:(0,He.SU)(i).anchor},{default:(0,n.w5)((()=>[(0,n.Wm)(at,{class:"slab full",onTap:a,asset:(0,He.SU)(i).asset},null,8,["asset"])])),_:1},8,["x","y","w","h","anchor"])])),_:1}))}});const aa=(0,u.Z)(ta,[["__scopeId","data-v-8362414c"]]);var oa=aa,na={BlankPage:Ve,TestLoadingPage:Ge,IAMLandingPage:Pt,IAMMosaicPage:Jt,IAMMosaicOutcomePage:ea,IAMMosaicOnboardingPage:oa};function sa(e,t){document.documentElement.style.setProperty(e,t)}var la=(0,n.aZ)({__name:"NewContext",setup(e){const t=(0,n.f3)("appTools"),a=(0,n.f3)("gameTools"),o=(0,He.iH)([100,100]);(0,n.JJ)("contextTools",{pageSize:o});const s=(0,n.Fl)((()=>t.debugMode.value)),i=t.windowSize,r=(0,He.iH)(null);(0,n.bv)((()=>{let e=null,l=null;(0,n.m0)((()=>{let n=0,r=0,u=i.value[0],c=i.value[1];1==(0,He.Tn)(s)&&(r=400,u-=400),e=u,l=c;let d=u/c,_=a.currentPage.value?.minAspectRatio||a.game.value.minAspectRatio||21/32,g=a.currentPage.value?.maxAspectRatio||a.game.value.maxAspectRatio||.5;a.game.value.disableAR&&(_=10,g=.1),a.game.value.squareAR&&(_=1,g=1);const p=t.forceAspectRatio.value;p&&(_=p,g=p),d<g?(c=u/g,d=g):d>_&&(u=c*_,d=_),"fullscreen"==a.currentPage.value?.layoutMode&&(u=i.value[0],c=i.value[1]),a.viewportSize.value=[u,c],window._targetWidth=u,window._targetHeight=c,window._aspectRatio=d;let m=(d-g)/(_-g),h=1-m;1!=(0,He.Tn)(s)&&(r=Math.round(.5*(i.value[0]-u)));let v=a.game.value.warningBottom;v&&(c*=1-v);let w=a.game.value.warningTop;w&&(n=.1*c,c*=1-w),o.value=[u,c],sa("--top",n+"px"),sa("--width",u+"px"),sa("--height",c+"px"),sa("--w",u+"px"),sa("--h",c+"px"),sa("--page-width",u+"px"),sa("--page-height",c+"px"),sa("--window-width",i.value[0]+"px"),sa("--window-height",i.value[1]+"px"),sa("--width-no-px",u),sa("--height-no-px",c),sa("--scale-factor",u/600),sa("--aspect-ratio",d),sa("--tallness",h),sa("--wideness",m),sa("--left",r+"px")}))}));const u=(0,n.Fl)((()=>a.gameName.value)),c=(0,n.Fl)((()=>a.game.value.warning?a.game.value.warning:(console.warn("warning: no warning image found"),""))),d=(0,n.Fl)((()=>a.game.value.smallDisclaimer?a.game.value.smallDisclaimer:"")),_=(0,n.Fl)((()=>a.game.value.warningBottom)),g=(0,n.Fl)((()=>a.game.value.warningTop));return(e,t)=>((0,n.wg)(),(0,n.iD)("div",{class:"new-context",ref_key:"contextElement",ref:r},[(0,n.WI)(e.$slots,"default"),d.value?((0,n.wg)(),(0,n.iD)("div",{key:0,class:"legacy-small-disclaimer contain",style:(0,l.j5)({"background-image":"url(vault/"+u.value+"/"+d.value+")"})},null,4)):(0,n.kq)("",!0),g.value?((0,n.wg)(),(0,n.iD)("div",{key:1,class:"legacy-warning top contain",style:(0,l.j5)({"background-image":"url(vault/"+u.value+"/"+c.value+")"})},null,4)):(0,n.kq)("",!0),_.value?((0,n.wg)(),(0,n.iD)("div",{key:2,class:"new-warning bottom contain",style:(0,l.j5)({"background-image":`url('vault/${u.value}/${c.value}')`})},null,4)):(0,n.kq)("",!0)],512))}}),ia=a(960),ra=a.n(ia);"function"===typeof ra()&&ra()(la);const ua=la;var ca=ua,da={NewContext:ca};let _a=()=>{};function ga(e,t,a){return new Promise(((o,n)=>{let s=new Image;s.onload=()=>{o(s)},s.onerror=()=>{n(new Error(`failed to preload '${e}' - key ${a}`))},t?setTimeout((()=>{s.src=e}),Math.floor(2e3*Math.random())):s.src=e}))}function pa(e,t){t=t||((e,t)=>{_a(`default handler ${e}/${t}`)});let a=e.length,o=0,n=e.map((async e=>{let n=await e;return o+=1,t(o,a),n}));return Promise.all(n)}location.host.indexOf(":8094")>-1&&(_a=console.log),window.debugLog=_a;var ma=(0,n.aZ)({name:"GameViewer",components:{Lottie:ce,DebugPanel:X,LoadingBar:oe,...na,...da},props:{},computed:{locales(){let e=Object.keys((this.page||{}).text||{});return 0==e.length&&(e=["en"]),e},page(){return this.pages[this.currentPageIndex]},gameNames(){let e=Object.keys(_e);return e.sort(),e}},data:()=>({aggressiveLoading:!1,games:_e,pages:[],gameName:"",loading:!0,simulateSlowLoading:!1,simulateFailingLoading:!1,currentPageIndex:0,scratchPad:{},problems:[],defaultGame:"gameList",debugMode:!1,pageParams:{alpha:0,beta:0,gamma:0},sessionId:"",clientId:"",benchmarkResults:null,auraEnabled:!0,fixedSize:!1,showElementsEnabled:!1,loadedImageURLs:[],local:!1,contextType:"DefaultContext",bgColor:"white",loadingPercent:0,preloadCountDone:0,preloadCountTotal:1,veryTall:!1,currentLocale:"en",gridMode:!1,game:null,gamePageSize:[0,0]}),watch:{fixedSize(){window._fixedSize=this.fixedSize,window._refreshFixedSize&&(console.log("calling refresh"),window._refreshFixedSize())},showElementsEnabled(){this.showElementsEnabled?document.body.style.setProperty("--element-outline-color","#F0F"):document.body.style.setProperty("--element-outline-color","transparent")},currentPageIndex(){window._page_index=this.currentPageIndex;let e=this.pages[this.currentPageIndex];e&&e["title"]&&(document.title=e["title"])}},methods:{locationHash(){return window.location.hash.slice(1)},updateScratchPad(e){for(let[t,a]of Object.entries(e||{}))this.scratchPad[t]=a},benchmark(e){let t=Date.now(),a=50,o=0,n=0;while(Date.now()-t<a){if(0===e)for(let e=0;e<11e3;e++)n+=e/Math.PI;else if(1===e){let e=new Array(2900).fill(0);for(let t=0;t<2900;t++)e[t]=t,n+=e[t]}else if(2===e){let e={};for(let t=0;t<500;t++)e[t+""]=t;n=Object.keys(e).length}o++}return o},benchmarks(){var e=[];for(let t=0;t<3;t++)e.push(this.benchmark(t));return e},async performQueryForward(){let e;if(window._uuid=null,e=location.hostname.endsWith(".org.uk")?"TESTING":(location.toString().split("?query=")[1]||"").split("#")[0],!e)return;try{e=decodeURIComponent(e)}catch(l){return console.error(l),""}let t={clientId:this.clientId,sessionId:this.sessionId,gameName:this.gameName,queryString:e};window.queryPayload=t;let a=atob("aHR0cHM6Ly9wbWkuaW4tbW90aW9uLnZpZGVvL2ZlZWQvZHRl"),o=a+"?"+(0,ge.Hs)(JSON.stringify(t)),n={mode:"cors",method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}};if(this.auraEnabled){var s;console.log("#a"),_a("performing fetch request..."),_a(`fetch URL = ${o}`);try{s=window.fr=await fetch(o,n)}catch(l){return console.log("#e"),_a(`fetch failed - exception: ${l.message}`),void console.error(l)}if(200!==s.status)console.log("#f"),_a(`fetch failed ${s.status}: ${s.statusText} -- "${await s.text()}"`);else{const e=await s.text();try{console.log("##s - ",e);const t=JSON.parse(e);window._queryResult=t,console.log("setting fullName"),window._fullName=`${t.firstName} ${t.lastName}`,"object"==typeof t.gameState?window._initialGameState=t.gameState:"string"==typeof t.gameState&&(""==t.gameState||"{}"==t.gameState||(window._initialGameState=JSON.parse(t.gameState))),console.log("initial game state:"),console.log(window._initialGameState),window._uuid=t.uuid}catch(l){console.log("error parsing"),console.log(e),console.error(l)}}}},async recordEvent(e,t){let a;console.log(`## Event recorded: ${e} : ${JSON.stringify(t)}`);let o="https://pmi.in-motion.video/feed/update",n={screenSize:[window.screen.width,window.screen.height],windowSize:[document.documentElement.clientWidth,document.documentElement.clientHeight],localTime:Date.now()-0,scratchPad:this.scratchPad,currentPageIndex:null,pageCount:this.pages.length,gameName:this.gameName,clientId:this.clientId,sessionId:this.sessionId,deployData:pe,windowLocationHref:a,benchmarkResults:this.benchmarkResults,ua:navigator.userAgent,eventName:e,eventArg:t};window.auraPayload=n;let s=o+"?"+(0,ge.Hs)(JSON.stringify(n)),l={mode:"cors",method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}};btoa(JSON.stringify(n));if(this.auraEnabled){var i;_a("performing fetch request..."),_a(`fetch URL = ${s}`),_a(`payload: ${JSON.stringify(n,null,2)}`);try{i=window.fr=await fetch(s,l),window._auraPageDone=this.currentPageIndex}catch(r){return _a(`fetch failed - exception: ${r.message}`),void console.error(r)}200!==i.status?_a(`fetch failed ${i.status}: ${i.statusText} -- "${await i.text()}"`):_a(`fetch success ${i.status}: ${i.statusText} -- "${await i.text()}"`)}else _a(s),_a(l)},async performFetch(){let e,t="https://pmi.in-motion.video/feed/update",a={screenSize:[window.screen.width,window.screen.height],windowSize:[document.documentElement.clientWidth,document.documentElement.clientHeight],localTime:Date.now()-0,scratchPad:this.scratchPad,currentPageIndex:this.currentPageIndex,pageCount:this.pages.length,gameName:this.gameName,clientId:this.clientId,sessionId:this.sessionId,deployData:pe,windowLocationHref:e,benchmarkResults:this.benchmarkResults,ua:navigator.userAgent};window.auraPayload=a;let o=t+"?"+(0,ge.Hs)(JSON.stringify(a)),n={mode:"cors",method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}};btoa(JSON.stringify(a));if(this.auraEnabled){var s;_a("performing fetch request..."),_a(`fetch URL = ${o}`),_a(`payload: ${JSON.stringify(a,null,2)}`);try{s=window.fr=await fetch(o,n),window._auraPageDone=this.currentPageIndex}catch(l){return _a(`fetch failed - exception: ${l.message}`),void console.error(l)}200!==s.status?_a(`fetch failed ${s.status}: ${s.statusText} -- "${await s.text()}"`):_a(`fetch success ${s.status}: ${s.statusText} -- "${await s.text()}"`)}else _a(o),_a(n)},async nextPage(e){window._auraPageDone=void 0,this.currentPageIndex++,this.currentPageIndex>=this.pages.length&&(this.currentPageIndex=0),_a(`moving to page ${this.currentPageIndex}`);for(let[t,a]of Object.entries(e||{}))this.scratchPad[t]=a;await this.performFetch()},async jumpToPage(e){window._auraPageDone=void 0,_a("jumpToPage ",e),this.currentPageIndex=e,await this.performFetch()},async jumpRelative(e){window._auraPageDone=void 0;let t=Math.max(0,Math.min(this.pages.length-1,this.currentPageIndex+e));_a("jumpRelative increment ",e," - ",this.currentPageIndex," --\x3e ",t),this.currentPageIndex=t,await this.performFetch()},async preloadPage(e,t,a){const o=this.pages[e],n={};for(const[s,i]of Object.entries(o))"type"!==s&&(0,l.HD)(i)&&(n[s]=i);await this.preloadResources(n,t,a)},async preloadResources(e,t,a){let o=[];window._images=window._images||{},window.sounds=window.sounds||{},window.soundPlayers=window.soundPlayers||{};for(const[s,i]of Object.entries(e)){let e=(0,l.HD)(i)&&(i.endsWith(".png")||i.endsWith(".jpg")),t=(0,l.HD)(i)&&(i.endsWith(".mp3")||i.endsWith(".ogg")),a=(0,l.HD)(i)&&i.endsWith(".glb");if(e){let e=async()=>{let e=await ga((0,ge.Nh)(i),this.simulateSlowLoading,s);return this.loadedImageURLs.push(i),window._images[s]=e,e};o.push(e)}else if(t){let e=async()=>{if(window.sounds[i])return;const e=window.audioContext=window.audioContext||new AudioContext;let t=(0,ge.Nh)(i),a=await window.fetch(t),o=await a.arrayBuffer(),n=await e.decodeAudioData(o);window.sounds[i]=n,window.soundPlayers[i]=t=>{const a=e.createBufferSource();a.buffer=n;var o=e.createGain();o.gain.value=t,o.connect(e.destination),a.connect(o),a.start()}};o.push(e)}else if(a){let e=async()=>{};o.push(e)}}try{if(t){let e=[];for(let t of o)if(this.simulateSlowLoading){let a=async()=>{await(0,ge._v)(4e3*Math.random()),await t()};e.push(a())}else e.push(t());await pa(e,a)}else{let e=0;for(let t of o)a(e,o.length),await t(),e++}}catch(n){_a("failed to preload!"),console.error(n)}},async localeClick(e){let t=this.currentPageIndex;await this.loadGame(this.gameName,this.debugMode,e),this.jumpToPage(t)},async loadGame(e,t,a=null){a&&(this.currentLocale=a,window._locale=a),this.preloadCountTotal=1,this.preloadCountDone=0,this.loading=!0,t&&setTimeout((()=>{let t=document.getElementById("game-"+e);t&&t.scrollIntoView()}),500),this.loadedImageURLs=[],"#"==e[e.length-1]&&(e=e.slice(0,e.length-1)),_a(`loadGame ${e}`);{let t="";if(window.location.host.endsWith(".org.uk"))t="@"+window.location.host.split(".")[0];else if(window.location.host.startsWith("localhost:")||window.location.host.startsWith("127.0.0.1:")){t="@local";for(let e of["favicon-apple","favicon-16","favicon-32"]){if(document.getElementById(e).href.includes("favicon/local"))break;document.getElementById(e).href=document.getElementById(e).href.replace("favicon/","favicon/local/")}}document.title=`${e}:sge${t}`}window.gameName=e,this.sessionId=(0,ge.Bu)(),window._sessionId=this.sessionId,t&&(window.debugMode=!0,window.location.hash="#"+e+(t?"/debug":"")+(window._locale?`/locale=${window._locale}`:"")),this.gameName=e;let o=this.games[this.gameName];if(o.noLegacy)throw new Error("New games not supported in legacy viewer");this.pages=o.pages,window._game_name=e,window._game=o,this.game=o,o.context&&(this.contextType=o.context);let n=this.games[this.gameName].bgColor||"magenta";if(document.body.style.setProperty("--brand-background-color",n),this.currentPageIndex=0,this.scratchPad={},!this.pages)return this.problems.push(`game ${this.gameName} not found`),void console.warn(`game ${this.gameName} not found. aborting`);await this.preloadPage(0,this.aggressiveLoading,((e,t)=>{this.preloadCountTotal=t,this.preloadCountDone=e})),window.parent.postMessage("loaded","*"),_a("first page preloaded. Preloading other pages..."),(async()=>{await this.performQueryForward(),await this.performFetch()})(),(async()=>{for(let e=1;e<this.pages.length;e++)await this.preloadPage(e,!1,(()=>{}))})(),_a("all preloading done"),this.loading=!1},debugButtonClick(){this.debugMode=!this.debugMode}},async mounted(){function e(e){try{return localStorage.getItem(e)}catch(t){return console.warn("LocalStorage get failed"),console.error(t),null}}function t(e,t){try{return localStorage.setItem(e,t)}catch(a){return console.warn("LocalStorage set failed"),console.error(a),null}}console.log("GameViewer mounted"),window._performQueryForward=()=>this.performQueryForward(),window._gameViewer=this,window._recordEvent=(e,t)=>{this.recordEvent(e,t)},window._game_viewer=this,location.host.indexOf(":8094")>-1&&(this.local=!0,window._local=!0,this.auraEnabled=!1),window._auraEnabled=this.auraEnabled;try{window.parent&&window.parent!=window&&window.parent._clientId?this.clientId=window.parent._clientId:this.clientId=e("clientId")}catch(l){this.clientId=e("clientId")}function a(e){let t=e.split("/");return{gameName:t[0],debugMode:t.indexOf("debug")>-1,locale:(t.filter((e=>e.startsWith("locale=")))[0]||"=en").split("=")[1]}}this.clientId||(this.clientId=(0,ge.Bu)(),t("clientId",this.clientId)),window._clientId=this.clientId,window.games=this.games,window.loadGame=e=>{this.loadGame(e,!0)};const o=()=>{let e=a(this.locationHash());this.debugMode=e.debugMode,window._locale=e.locale||"en",this.currentLocale=window._locale,this.debugMode||e.gameName?this.loadGame(e.gameName||this.defaultGame,this.debugMode,this.currentLocale):this.loadGame(pe.gameName,!1,this.currentLocale)};o(),window.onhashchange=function(){o(),window.parent.postMessage("onhashchange","*")},this.benchmarkResults=this.benchmarks(),this.heartbeatHandle=setInterval((()=>{window.parent.postMessage("heartbeat","*")}),200),document.addEventListener("keydown",(e=>{console.log(e.key,e.ctrlKey,e.altKey),"D"==e.key&&e.ctrlKey&&e.altKey&&(console.log("flipping debug"),this.debugMode=!this.debugMode,console.log(this.debugMode)),"G"==e.key&&e.ctrlKey&&e.altKey&&(this.gridMode=!this.gridMode)})),window._keyHandlers={},window._keyUpHandlers={},window._onKey=(e,t)=>{window._keyHandlers[e]=window._keyHandlers[e]||[],window._keyHandlers[e].push(t)},window._offKey=(e,t)=>{window._keyHandlers[e]=window._keyHandlers[e]||[],window._keyHandlers[e]=window._keyHandlers[e].filter((e=>e!=t))},window._onKeyUp=(e,t)=>{window._keyUpHandlers[e]=window._keyUpHandlers[e]||[],window._keyUpHandlers[e].push(t)},window._offKeyUp=(e,t)=>{window._keyUpHandlers[e]=window._keyUpHandlers[e]||[],window._keyUpHandlers[e]=window._keyUpHandlers[e].filter((e=>e!=t))},window._clearKeyHandlers=()=>{window._keyHandlers={},window._keyUpHandlers={}},document.addEventListener("keydown",(e=>{window._keyHandlers[e.key]&&window._keyHandlers[e.key].forEach((t=>t(e)))})),document.addEventListener("keyup",(e=>{window._keyUpHandlers[e.key]&&window._keyUpHandlers[e.key].forEach((t=>t(e)))}));const s=async()=>{await(0,n.Y3)(),this.gamePageSize=[window._targetWidth,window._targetHeight]};(async()=>{await(0,ge._v)(500),s()})(),window.addEventListener("resize",s)},unmounted(){clearInterval(this.heartbeatHandle)}});const ha=(0,u.Z)(ma,[["render",H]]);var va=ha;function wa(){let e="";if(window.location.host.endsWith(".org.uk"))e="@"+window.location.host.split(".")[0];else if(window.location.host.startsWith("localhost:")||window.location.host.startsWith("127.0.0.1:")){e="@local";for(const e of["favicon-apple","favicon-16","favicon-32"]){const t=document.getElementById(e);if(t.href.includes("favicon/local"))break;t.href=t.href.replace("favicon/","favicon/local/")}}}function fa(){window._keyHandlers={},window._keyUpHandlers={},window._onKey=(e,t)=>{window._keyHandlers[e]=window._keyHandlers[e]||[],window._keyHandlers[e].push(t)},window._offKey=(e,t)=>{window._keyHandlers[e]=window._keyHandlers[e]||[],window._keyHandlers[e]=window._keyHandlers[e].filter((e=>e!=t))},window._onKeyUp=(e,t)=>{window._keyUpHandlers[e]=window._keyUpHandlers[e]||[],window._keyUpHandlers[e].push(t)},window._offKeyUp=(e,t)=>{window._keyUpHandlers[e]=window._keyUpHandlers[e]||[],window._keyUpHandlers[e]=window._keyUpHandlers[e].filter((e=>e!=t))},window._clearKeyHandlers=()=>{window._keyHandlers={},window._keyUpHandlers={}},document.addEventListener("keydown",(e=>{window._keyHandlers[e.key]&&window._keyHandlers[e.key].forEach((t=>t(e)))})),document.addEventListener("keyup",(e=>{window._keyUpHandlers[e.key]&&window._keyUpHandlers[e.key].forEach((t=>t(e)))}))}var ya=a(232);const Ea=(0,u.Z)(ya.Z,[["__scopeId","data-v-c81fab9a"]]);var Pa=Ea,ba=a(577);function Ma(){const e=(0,He.iH)([1,1]);function t(){e.value=[window.innerWidth,window.innerHeight]}window.addEventListener("resize",t),t();const a=setInterval((()=>{1==e.value[0]||0==e.value[0]?t():clearInterval(a)}),50);return window.updateWindowSize=t,window._size=e,e}const Da=(0,He.iH)(window.location.hash.slice(1));let ka=!1;window.onhashchange=function(){ka||(ka=!0,Da.value=window.location.hash.slice(1),ka=!1,window.parent.postMessage("onhashchange","*"))},(0,n.YP)(Da,(e=>{ka||(ka=!0,window.location.hash="#"+e,ka=!1)}));const Oa={};async function Ua(e){const[t,a]=(0,ge.wA)([10,10]);a.font="100px NonexistantFamily";const o="Mg01234567890abcdefjKL!,yA",n=a.measureText(o);let s=1;while(1){a.font="100px "+e;const t=a.measureText(o);if(n.width!=t.width)return!0;await(0,ge._v)(Math.min(500,10*s)),s+=1}}async function Ia(e,t){const a=new FontFace(e,`url(${t})`);return await a.load(),a}function Ta(e,t){let a=document.getElementById(e);a&&document.getElementsByTagName("head")[0].removeChild(a),a=document.createElement("style"),a.type="text/css",a.id=e,a.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(a)}async function xa(e,t,a){const o=e+(a?"_italic":"");if(Oa[o])return;Oa[o]=1;const n=`\n    @font-face {\n    font-family: ${e};\n    src: url(${t});\n    }\n    `,s=e+(a?"_italic":"");Ta(`${s}`,n)}var Ca=a(424),Wa=a(913);const La={class:"caption"},Sa={class:"number"},Aa={class:"track"},Ba={class:"track-inner"};var Ra=(0,n.aZ)({__name:"FloatTinker",props:(0,n.Vf)({adaptExtents:{type:Boolean},adaptSpeed:{type:Boolean},speed:{default:.005},min:{default:0},max:{default:1},caption:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){function t(e){return void 0==e?"--":0==e?"0":Math.abs(e)<1e-5?"~0":Math.abs(e)<.01?e.toFixed(5):Math.abs(e)<.1?e.toFixed(3):Math.abs(e)<5?e.toFixed(2):Math.abs(e)<30?e.toFixed(1):`${Math.floor(e)}`}const a=(0,n.tT)(e,"modelValue"),o=e,s=(0,He.iH)(o.min),i=(0,He.iH)(o.max),r=(0,He.iH)(o.speed);function u(){a.value=Math.max(o.min,a.value||0),s.value=o.min}function c(){a.value=Math.min(o.max,a.value||0),i.value=o.max}function d(e){return(0,Wa.ZZ)(e,s.value,i.value,0,200)}const _=(0,n.Fl)((()=>d(a.value||0))),g=(0,n.Fl)((()=>d(0)));(0,n.m0)((()=>{o.adaptExtents?(s.value=Math.min(a.value||0,s.value),i.value=Math.max(a.value||0,i.value)):a.value=Math.min(Math.max(s.value,a.value||0),i.value)}));const p=(0,n.Fl)((()=>i.value-s.value)),m=(0,He.iH)();return Zt(m).start((e=>{e.move((()=>{a.value=(a.value||0)+e.delta[0]*r.value*p.value}))})),(e,o)=>((0,n.wg)(),(0,n.iD)("div",{ref_key:"el",ref:m,style:{display:"flex"},class:"container"},[(0,n._)("div",La,(0,l.zw)(e.caption),1),(0,n._)("div",Sa,(0,l.zw)(t(a.value)),1),(0,n._)("div",Aa,[(0,n._)("div",Ba,[(0,n._)("div",{class:"plus",style:(0,l.j5)({left:`${_.value}px`})},"+",4),(0,n._)("div",{class:"marking",style:(0,l.j5)([{left:"20px",transform:"translate(-50%, 0%)","line-height":"32px",height:"32px",width:"3px",background:"rgba(192,192,192,0.55)"},{left:`${g.value}px`}])},null,4),(0,n._)("div",{class:"marking",style:{left:"0","line-height":"32px","padding-left":"2px"},onClick:u},(0,l.zw)(t(s.value)),1),(0,n._)("div",{class:"marking",style:{right:"0","line-height":"32px","padding-right":"2px"},onClick:c},(0,l.zw)(t(i.value)),1)])])],512))}});const Va=(0,u.Z)(Ra,[["__scopeId","data-v-175e0911"]]);var Ha=Va;const $a={ref:"el",style:{display:"flex"}},Ka={class:"container your-element",style:{}},Na={class:"txt"};function za(e,t){return(0,n.wg)(),(0,n.iD)("div",$a,[(0,n._)("div",Ka,[(0,n._)("span",Na,[(0,n.WI)(e.$slots,"default",{},void 0,!0)]),t[0]||(t[0]=(0,n._)("span",{class:"remaining-space"},null,-1))])],512)}const ja={},Fa=(0,u.Z)(ja,[["render",za],["__scopeId","data-v-16099a54"]]);var qa=Fa;const Za={style:{display:"flex","flex-direction":"row"}},Ga=["value","selected"];var Ya=(0,n.aZ)({__name:"AssetEditor2",props:{modelValue:{},modelModifiers:{}},emits:(0,n.Vf)(["update:modelValue"],["update:modelValue"]),setup(e,{emit:t}){const{gameTools:a,pageTools:o}=it();function s(e){const t=o.config.value,a=t[e];if("string"==typeof a)return a;console.warn("asset not found")}function i(e){const t=o.config.value,n=s(e);if("string"==typeof n){const e=a.currentVariant.value||"";return`vault/${a.getGameNameNonReactive()}/${e?e+"/":""}${n}`}console.warn(`asset not found in ${a.getGameNameNonReactive()}.mjs: page #${a.getCurrentPageIndexNonReactive()} ${t.type} : ${e}`)}const r=(0,n.Fl)((()=>{if(!o.config.value)return;let e=Object.entries(o.config.value).filter((([e,t])=>"string"==typeof t&&(t.endsWith(".png")||t.endsWith(".webp")||t.endsWith(".jpg")))).map((([e,t])=>e));return e}));function u(e){console.log(e.target.value),d("update:modelValue",e.target.value)}const c=(0,n.Fl)((()=>_.value?{"background-image":"url('"+i(_.value||"")+"')"}:{}));const d=t,_=(0,n.tT)(e,"modelValue");return(e,t)=>((0,n.wg)(),(0,n.iD)("div",Za,[(0,n._)("select",{onInput:u},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.value,((e,t)=>((0,n.wg)(),(0,n.iD)("option",{key:t,value:e,selected:e==_.value},(0,l.zw)(e),9,Ga)))),128))],32),(0,n._)("div",{class:"preview",style:(0,l.j5)(c.value)},null,4)]))}});const Ja=(0,u.Z)(Ya,[["__scopeId","data-v-5d8a636a"]]);var Qa=Ja;const Xa={key:0},eo={key:1},to={key:2},ao={key:3},oo={key:4},no=["onClick"],so={key:5},lo={style:{"font-weight":"bold"}},io={key:6};var ro=(0,n.aZ)({__name:"ProtoTinkerWindow",setup(e){const{pageTools:t,gameTools:a}=it(),{pts:o,protoTinkersVersion:s}=ft();a.currentPage;async function i(){await mt(t,a)}return(e,t)=>(0,He.SU)(s)>0&&(0,He.SU)(o).length>0?((0,n.wg)(),(0,n.iD)("div",Xa,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,He.SU)(o).values(),((e,t)=>((0,n.wg)(),(0,n.iD)("div",{key:t},["heading"==e.type?((0,n.wg)(),(0,n.j4)(qa,{key:0},{default:(0,n.w5)((()=>[(0,n.Uk)((0,l.zw)(e.name),1)])),_:2},1024)):(0,n.kq)("",!0),"number"==e.type?((0,n.wg)(),(0,n.iD)("div",eo,[(0,n.Wm)(Ha,{modelValue:e.data.value,"onUpdate:modelValue":t=>e.data.value=t,caption:e.name,adaptExtents:!0},null,8,["modelValue","onUpdate:modelValue","caption"])])):(0,n.kq)("",!0),"v2"==e.type?((0,n.wg)(),(0,n.iD)("div",to,[(0,n.Wm)(Ha,{modelValue:e.data.value[0],"onUpdate:modelValue":t=>e.data.value[0]=t,caption:`${e.name} x`,adaptExtents:!0},null,8,["modelValue","onUpdate:modelValue","caption"]),(0,n.Wm)(Ha,{modelValue:e.data.value[1],"onUpdate:modelValue":t=>e.data.value[1]=t,caption:`${e.name} y`,adaptExtents:!0},null,8,["modelValue","onUpdate:modelValue","caption"])])):(0,n.kq)("",!0),"hero2"==e.type?((0,n.wg)(),(0,n.iD)("div",ao,[(0,n.Wm)(Ha,{modelValue:e.data.value.pos[0],"onUpdate:modelValue":t=>e.data.value.pos[0]=t,caption:`${e.name} x`,adaptExtents:!0},null,8,["modelValue","onUpdate:modelValue","caption"]),(0,n.Wm)(Ha,{modelValue:e.data.value.pos[1],"onUpdate:modelValue":t=>e.data.value.pos[1]=t,caption:`${e.name} y`,adaptExtents:!0},null,8,["modelValue","onUpdate:modelValue","caption"]),(0,n.Wm)(Ha,{modelValue:e.data.value.size[0],"onUpdate:modelValue":t=>e.data.value.size[0]=t,caption:`${e.name} w`,adaptExtents:!0},null,8,["modelValue","onUpdate:modelValue","caption"]),(0,n.Wm)(Ha,{modelValue:e.data.value.size[1],"onUpdate:modelValue":t=>e.data.value.size[1]=t,caption:`${e.name} h`,adaptExtents:!0},null,8,["modelValue","onUpdate:modelValue","caption"])])):(0,n.kq)("",!0),"button"==e.type?((0,n.wg)(),(0,n.iD)("div",oo,[(0,n._)("button",{onClick:t=>e.closure()},(0,l.zw)(e.name),9,no)])):(0,n.kq)("",!0),"textDisplay"==e.type?((0,n.wg)(),(0,n.iD)("div",so,[(0,n._)("span",lo,(0,l.zw)(e.name),1),(0,n.Uk)(": "+(0,l.zw)(e.data.value),1)])):(0,n.kq)("",!0),"asset"==e.type?((0,n.wg)(),(0,n.iD)("div",io,[(0,n.Wm)(Qa,{modelValue:e.data.value,"onUpdate:modelValue":t=>e.data.value=t},null,8,["modelValue","onUpdate:modelValue"])])):(0,n.kq)("",!0)])))),128)),(0,n._)("button",{onClick:i,class:"commit-button"},"💾 commit")])):(0,n.kq)("",!0)}});const uo=(0,u.Z)(ro,[["__scopeId","data-v-6625e456"]]);var co=uo;const _o={style:{outline:"1px solid red",width:"100%",height:"100%",display:"flex","flex-direction":"column"}},go={class:"buttons",style:{height:"calc(var(--width) * 0.04)",display:"flex","flex-direction":"row"}},po=["disabled"],mo=["disabled"];var ho={__name:"JSONEditor",props:{modelValue:{default:{}}},emits:["update:modelValue"],setup(e,{emit:t}){const a=t,s=e;function i(e){try{return JSON.parse(e),!0}catch(t){return!1}}const r=(0,He.iH)("{}"),u=(0,n.Fl)((()=>i(r.value))),c=(0,n.Fl)((()=>r.value!==JSON.stringify(s.modelValue,null,2))),d=c;function _(){console.log("commit click"),u.value&&(console.log("valid - committing"),a("update:modelValue",JSON.parse(r.value)))}function g(){p()}function p(){r.value=JSON.stringify(s.modelValue,null,2)}return(0,n.bv)((()=>{p()})),(e,t)=>((0,n.wg)(),(0,n.iD)("div",_o,[(0,n.wy)((0,n._)("textarea",{autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false","onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),class:(0,l.C_)((u.value?"valid":"invalid")+((0,He.SU)(d)?" can-commit":" cant-commit")),style:{"flex-grow":"1"}},null,2),[[o.nr,r.value]]),(0,n._)("div",go,[(0,n._)("div",{class:(0,l.C_)("button"),disabled:!((0,He.SU)(d)&&u.value),onClick:_},"commit",8,po),(0,n._)("div",{class:"button",disabled:!(0,He.SU)(d),onClick:g},"revert",8,mo)])]))}};const vo=(0,u.Z)(ho,[["__scopeId","data-v-dc1fb51a"]]);var wo=vo;const fo={key:0},yo={style:{height:"300px"}};var Eo=(0,n.aZ)({__name:"PageAdmin",setup(e){const{pageTools:t}=it(),a=t.config,s=(0,He.iH)(t.pageType.value);async function i(){await _t("clonePage",{sourceType:t.pageType.value,destType:s.value})}return(e,r)=>((0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("h2",null,(0,l.zw)((0,He.SU)(t).pageName||(0,He.SU)(t).pageType),1),(0,He.SU)(t).pageName?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",fo,"type: "+(0,l.zw)((0,He.SU)(t).pageName),1)),(0,n._)("div",yo,[(0,n.Wm)(wo,{modelValue:(0,He.SU)(a),"onUpdate:modelValue":r[0]||(r[0]=e=>(0,He.dq)(a)?a.value=e:null)},null,8,["modelValue"])]),r[2]||(r[2]=(0,n._)("h2",null,"Clone Page",-1)),(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":r[1]||(r[1]=e=>s.value=e)},null,512),[[o.nr,s.value]]),(0,n._)("button",{onClick:i},"Clone")]))}});const Po=(0,u.Z)(Eo,[["__scopeId","data-v-1f10ab30"]]);var bo=Po;function Mo(e,t){return(0,n.wg)(),(0,n.iD)("div",null,"Game Admin")}const Do={},ko=(0,u.Z)(Do,[["render",Mo]]);var Oo=ko;function Uo(e,t){return(0,n.wg)(),(0,n.iD)("div",null,"System Admin")}const Io={},To=(0,u.Z)(Io,[["render",Uo]]);var xo=To;function Co(e){const t=new XMLHttpRequest;return{generate(){const a={status:(0,He.iH)("created"),progress:(0,He.iH)(0),error:(0,He.iH)(null),size:(0,He.iH)(1),result:(0,He.iH)(void 0),trigger(){"created"==this.status.value&&(this.status.value="triggered",(async()=>{t.responseType="blob",t.onload=()=>{"aborted"!=this.status.value&&(this.result.value=t.response,this.status.value="resolved")},t.onprogress=e=>{"aborted"!=this.status.value&&e.lengthComputable&&(this.size.value=e.total,this.progress.value=e.loaded/e.total)},t.onerror=e=>{"aborted"!=this.status.value&&(this.error.value={error:e},this.status.value="error")},t.open("GET",e),t.send()})())},abort(){this.status.value="aborted",t.abort()}};return a}}}function Wo(e){return e.trigger(),new Promise(((t,a)=>{(0,n.m0)((()=>{void 0!=e.result.value&&t(e.result.value)})),(0,n.m0)((()=>{null!=e.error.value&&a(e.error.value)}))}))}function Lo(e){return new Promise(((t,a)=>{let o;o=(0,n.m0)((()=>{const a=(0,He.Tn)(e);a&&(t(a),o&&o())}))}))}function So(e,t){let a=!1,o=0;const s=(0,He.iH)(new Set),l={status:(0,He.iH)("created"),progress:(0,He.iH)(0),error:(0,He.iH)(null),size:(0,He.iH)(1),partialResult:(0,He.iH)(e.map((e=>null))),result:(0,He.iH)(void 0),abort(){if("triggered"==this.status.value){a=!0,this.status.value="aborted";for(const t of s.value)e[t].abort()}},trigger(){"created"==this.status.value&&(async()=>{this.status.value="triggered";(0,n.m0)((()=>{if(a)return;let t=0;for(const a of e)"resolved"==a.status.value?t+=1:t+=a.progress.value;this.progress.value=t/(e.length||1)}));while(o<e.length){if(a)return;if(s.value.size<t){s.value.add(o);const t=e[o];t.trigger();const a=o;(async()=>{const e=a,o=await Wo(t);this.partialResult.value[e]=o,s.value.delete(a),0==s.value.size&&(this.status.value="resolved",this.result.value=[...this.partialResult.value])})(),o++}await Lo((()=>s.value.size<t))}})()}};return l}const Ao={duration:1,failProbability:0,stallProbability:0,size:1,progressChunks:10,error:2};class Bo{resultValue;options;constructor(e,t){this.resultValue=e,this.options={...Ao,...t}}size=(0,He.iH)(1);status=(0,He.iH)("created");progress=(0,He.iH)(0);error=(0,He.iH)(null);result=(0,He.iH)(void 0);abort(){"triggered"==this.status.value&&(this.status.value="aborted")}trigger(){if("created"!=this.status.value)return;this.status.value="triggered",this.error.value=null;const e=1e3*this.options.duration/this.options.progressChunks,t=Math.random()<this.options.failProbability,a=Math.random()*this.options.progressChunks|0,o=Math.random()<this.options.stallProbability,n=Math.random()*this.options.progressChunks|0;(async()=>{for(let s=0;s<=this.options.progressChunks;s++){if(await(0,ge._v)(e),"aborted"==this.status.value)return;const l=s/this.options.progressChunks;if(this.progress.value=l,t&&a==s)return this.error.value=this.options.error,void(this.status.value="error");if(o&&n==s)while(1)await(0,ge._v)(1e3)}this.result.value=this.resultValue,this.status.value="resolved"})()}}function Ro(){const e=new Bo("moo",{duration:.5}),t=new Bo("bar",{duration:.7}),a=new Bo("foo",{duration:1}),o=new Bo("baz",{duration:1}),n=new Bo("wah",{duration:1}),s=new Bo("yay",{duration:2}),l=new Bo("poo",{duration:1});return[e,t,a,o,n,s,l]}class Vo{items={};pendingItems={};loadFunc;constructor(e){this.loadFunc=e}async load(e){let t;"string"===typeof e&&(e=[e]);for(const o of e){const n=this.items[o];if(n)return n;const s=this.pendingItems[o];if(s)return await s;t=this.loadFunc(o),this.pendingItems[o]=t;try{this.items[o]=await t}catch(a){throw console.warn(`error loading resource ${e}`),a}delete this.pendingItems[o]}if(t)return t;throw new Error("resource load failed")}get(e){const t=this.getOrNull(e);if(null==t)throw new Error(`${this.constructor.name}: resource not found ${e}`);return t}getOrNull(e){const t=Object.prototype.hasOwnProperty.call(this.items,e)?this.items[e]:null;return null===t&&console.warn(`resource ${e} not found`),t}}function Ho(e,t,a){let o={};o=window.progressRecords=window.progressRecords||o,window.progressRecords[e]={bytesDone:t,totalBytes:a,filename:e}}const $o={};function Ko(e){return new Promise(((t,a)=>{const o=(new fe.E).setPath(""),n=e;o.load(n,(function(a){window._gltf=a,a.$subs={},a.$filename=e;for(const e of a.scene.children)if("Object3D"===e.type)for(const t of e.children)if(t.name.indexOf("SCREEN")>-1){const o=t.clone();o.$originalPosition=o.position.clone(),window.poop=o;const n=e.matrix.clone().multiply(t.matrix);o.matrix.copy(n),o.matrixAutoUpdate=!1,a.$subs[e.name+"/"+o.name]=o}t(a)}),(t=>{Ho(e,t.loaded,t.loaded)}),(function(e){a(e)}))}))}class No extends Vo{constructor(){super(Ko)}getSubObject(e,t){const a=this.get(e);if(!a)return null;const o=a.$subs[t];return o||null}}const zo=$o["gltf"]=new No;function jo(e){return new Promise(((t,a)=>{const o=(new me.dpR).setPath(""),n=e;o.load(n,(function(a){a.wrapS=me.rpg,a.wrapT=me.rpg;const o=.2,n=Math.floor(a.image.width*a.image.height*o);Ho(e,n,n),t(a)}),(t=>{Ho(e,t.loaded,null)}))}))}class Fo extends Vo{constructor(){super(jo)}}$o["texture"]=new Fo;class qo extends Vo{constructor(){super((e=>(0,ge.Wq)(`${e}`)))}}$o["csv"]=new qo;class Zo extends Vo{constructor(){super((e=>(0,ge.Ol)(`${e}`)))}}$o["txt"]=new Zo;async function Go(e){const t=`vault/${window.gameName}/${e}`;return await new Promise((e=>{(new we.I).load(t,(function(t){e(t)}))}))}class Yo extends Vo{constructor(){super(Go)}loadEnvMap(e,t){const a=this.get(e);if(!a)return null;const o=new me.anP(t),n=o.fromEquirectangular(a),s=n.texture;return t.toneMapping=me.EoG,t.toneMappingExposure=1,t.outputEncoding=me.knz,s}}$o["exr"]=new Yo;async function Jo(e){const t=`${e}`;return await new Promise((e=>{(new ve.J).load(t,(function(t){e(t)}))}))}class Qo extends Vo{defaultFont=null;constructor(){super((async e=>{const t=await Jo(e);return this.defaultFont||(this.defaultFont=t),t}))}getDefaultFont(){if(!this.defaultFont)throw new Error("no fonts, can't select default font");return this.defaultFont}}$o["font"]=new Qo;class Xo{howls={};constructor(){}loadSprites(e,t){const a=`./vault/${window.gameName}/${e}`;return this.howls[e]=new he.Howl({src:[a],sprite:t}),new Promise((t=>{this.howls[e].once("load",t)}))}loadSound(e){const t=`./vault/${window.gameName}/${e}`;return this.howls[e]=new he.Howl({src:[t]}),new Promise((t=>{this.howls[e].once("load",t)}))}play(e,t){this.howls[e]?null!==t?this.howls[e].play(t):this.howls[e].play():console.warn("sound not found "+e)}}new Xo;const en={image:{png:1,jpg:1,webp:1},model:{glb:1,gltf:1},audio:{wav:1},animation:{json:1},font:{ttf:1,otf:1}},tn={...en.image,...en.model,...en.audio,...en.animation,...en.font};function an(e,t=null){if(!e||"string"!=typeof e)return!1;const a=e.split(".").pop().toLowerCase();return!!tn[a]||void 0}function on(e){return e.split(".").pop()||""}function nn(e){const t={};for(const[a,o]of Object.entries(e))"type"!==a&&"string"==typeof o&&an(o)&&(t[a]=o);return t}function sn(e,t,a=""){return`vault/${e}/${a}${a?"/":""}${t}`}async function ln(e,t,a=""){const o=sn(e,t,a);en.image[on(o)]?await rn(o):en.model[on(o)]&&await zo.load(o)}async function rn(e){await new Promise(((t,a)=>{const o=new Image;o.onload=()=>{t(o)},o.onerror=()=>{a(new Error(`failed to preload '${e}'`))},o.src=e}))}function un(e){return"string"==typeof e&&!!en.image[on(e)]}const cn={class:"label"},dn={style:{}},_n={class:"label"};var gn=(0,n.aZ)({__name:"AssetCatalogue",setup(e){const{gameTools:t,pageTools:a}=it(),o=(0,He.iH)(t.getGameNameNonReactive());function s(e){return{"background-image":`url('/sge2/vault/${o.value}/${e}')`}}(0,n.bv)((async()=>{const{dirContents:e}=await _t(`getAssetsOnDisk/${o.value}`,{});console.log(e),i.value=e.map((e=>({filename:e}))),r.value=Object.values(a.config.value).filter((e=>!!an(`${e}`))).map((e=>({filename:e})))}));const i=(0,He.iH)([]),r=(0,He.iH)([]);return(e,t)=>((0,n.wg)(),(0,n.iD)(n.HY,null,[t[0]||(t[0]=(0,n._)("h2",null,"Page Assets",-1)),(0,n._)("div",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.value,((e,t)=>((0,n.wg)(),(0,n.iD)("div",{key:t,class:"cell"},[(0,n._)("div",{class:"thumb",style:(0,l.j5)(s(e.filename))},null,4),(0,n._)("div",cn,(0,l.zw)(e.filename),1)])))),128))]),t[1]||(t[1]=(0,n._)("h2",null,"All Assets On Disk",-1)),(0,n._)("div",dn,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.value,((e,t)=>((0,n.wg)(),(0,n.iD)("div",{key:t,class:"cell"},[(0,n._)("div",{class:"thumb",style:(0,l.j5)(s(e.filename))},null,4),(0,n._)("div",_n,(0,l.zw)(e.filename),1)])))),128))])],64))}});const pn=(0,u.Z)(gn,[["__scopeId","data-v-79ddc74e"]]);var mn=pn;const hn={class:"nav-bar slab cols",style:{gap:"3px"}},vn={class:"cell",style:{"flex-grow":"0",width:"40px"}},wn={class:"cell"},fn={class:"cell"},yn={class:"cell"},En={class:"cell"},Pn={class:"cell"},bn={class:"rest"},Mn={key:0},Dn={key:1},kn={key:2},On={key:3},Un={key:4};var In=(0,n.aZ)({__name:"AuthorWindow",setup(e){const t=(0,ba.Y)("authorPageShown",1);function a(){t.value=1-t.value}const o=(0,ba.Y)("authorPageIndex",0);function s(e){o.value=e}return(e,i)=>((0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("div",{class:(0,l.C_)(["tinker-section",(0,He.SU)(t)?"shown":""])},[(0,n._)("div",hn,[(0,n._)("div",vn,[(0,n._)("button",{onClick:i[0]||(i[0]=e=>a()),class:(0,l.C_)(["slab",0==(0,He.SU)(o)?"selected":""]),style:{width:"100%"}},">>",2)]),(0,n._)("div",wn,[(0,n._)("button",{onClick:i[1]||(i[1]=e=>s(0)),class:(0,l.C_)(["slab",0==(0,He.SU)(o)?"selected":""]),style:{width:"100%"}},"Tinker",2)]),(0,n._)("div",fn,[(0,n._)("button",{onClick:i[2]||(i[2]=e=>s(1)),class:(0,l.C_)(["slab",1==(0,He.SU)(o)?"selected":""]),style:{width:"100%"}},"Page",2)]),(0,n._)("div",yn,[(0,n._)("button",{onClick:i[3]||(i[3]=e=>s(2)),class:(0,l.C_)(["slab",2==(0,He.SU)(o)?"selected":""]),style:{width:"100%"}},"Game",2)]),(0,n._)("div",En,[(0,n._)("button",{onClick:i[4]||(i[4]=e=>s(3)),class:(0,l.C_)(["slab",3==(0,He.SU)(o)?"selected":""]),style:{width:"100%"}},"System",2)]),(0,n._)("div",Pn,[(0,n._)("button",{onClick:i[5]||(i[5]=e=>s(4)),class:(0,l.C_)(["slab",4==(0,He.SU)(o)?"selected":""]),style:{width:"100%"}},"Assets",2)])]),(0,n._)("div",bn,[0==(0,He.SU)(o)?((0,n.wg)(),(0,n.iD)("div",Mn,[(0,n.Wm)(co)])):(0,n.kq)("",!0),1==(0,He.SU)(o)?((0,n.wg)(),(0,n.iD)("div",Dn,[(0,n.Wm)(bo)])):(0,n.kq)("",!0),2==(0,He.SU)(o)?((0,n.wg)(),(0,n.iD)("div",kn,[(0,n.Wm)(Oo)])):(0,n.kq)("",!0),3==(0,He.SU)(o)?((0,n.wg)(),(0,n.iD)("div",On,[(0,n.Wm)(xo)])):(0,n.kq)("",!0),4==(0,He.SU)(o)?((0,n.wg)(),(0,n.iD)("div",Un,[(0,n.Wm)(mn)])):(0,n.kq)("",!0)])],2),(0,n._)("div",{class:(0,l.C_)(["show-button",(0,He.SU)(t)?"":"shown"])},[(0,n._)("button",{onClick:i[6]||(i[6]=e=>a()),class:"slab",style:{width:"100%"}},"<<")],2)]))}});const Tn=(0,u.Z)(In,[["__scopeId","data-v-28810525"]]);var xn=Tn,Cn=(0,n.aZ)({__name:"PageViewer",props:{config:{default:{type:""}},disposeNow:{default:!1},pageIndex:{default:-1}},emits:["nextPage","disposeDone"],setup(e,{emit:t}){const a=t;function o(){a("nextPage")}const s=(0,n.Fl)((()=>c.config?.type)),i=(0,n.Fl)((()=>c.config?.name)),r=(0,n.Fl)((()=>na[s.value])),u=(0,n.f3)("gameTools"),c=e,d=(0,n.Fl)((()=>c.pageIndex));function _(e){const t=c.config[e];if("string"==typeof t)return t;console.warn(`asset not found in ${u.getGameNameNonReactive()}.mjs: page #${u.getCurrentPageIndexNonReactive().value} ${c.config.type} : ${e}`)}function g(e){const t=_(e);if("string"==typeof t){const e=u.currentVariant.value||"";return`vault/${u.getGameNameNonReactive()}/${e?e+"/":""}${t}`}console.warn(`asset not found in ${u.getGameNameNonReactive()}.mjs: page #${u.getCurrentPageIndexNonReactive()} ${c.config.type} : ${e}`)}const p=ct();let m=!1;return(0,n.m0)((()=>{c.disposeNow&&!m&&(m=!0,p.trigger(),a("disposeDone"))})),(0,n.JJ)("pageTools",{getAssetFilename:_,getAssetUrl:g,pageName:i,pageType:s,loadImageAsset(e){return new Promise(((t,a)=>{const o=new Image;o.onload=()=>t(o),o.onerror=()=>a();const n=g(e);n?o.src=n:a()}))},config:(0,n.Fl)((()=>c.config)),onDispose:p,pageIndex:d}),(e,t)=>((0,n.wg)(),(0,n.iD)("div",null,[((0,n.wg)(),(0,n.j4)(n.n4,null,{default:(0,n.w5)((()=>[((0,n.wg)(),(0,n.j4)((0,n.LL)(r.value),{class:(0,l.C_)("layout-"+(c.config["layoutMode"]||"portrait")),config:c.config,onNextPage:o},null,40,["class","config"]))])),_:1})),(0,n.Wm)(xn)]))}});const Wn=(0,u.Z)(Cn,[["__scopeId","data-v-2bf4c581"]]);var Ln=Wn;const Sn=(0,He.iH)({});let An=!1;function Bn(){return window.parent!=window}const Rn=(0,He.iH)(!1),Vn=(0,He.iH)(null),Hn=(0,He.iH)("firstName"),$n=(0,He.iH)("lastName");function Kn(){try{if(window.parent&&!Bn()&&window.parent._clientId)return window.parent._clientId}catch(e){return console.warn("failed to get clientId from parent"),void console.error(e)}}function Nn(){An||(An=!0,console.log("----------------------------------"),Rn.value=!0,Sn.value={clientId:Kn()||(0,ge._2)("clientId")||(0,ge.Bu)(),sessionId:Sn.value.sessionId||(0,ge.Bu)(),playId:(0,ge.Bu)(),uuid:void 0})}const zn=atob("aHR0cHM6Ly9wbWkuaW4tbW90aW9uLnZpZGVvL2ZlZWQvZHRl"),jn=atob("aHR0cHM6Ly9wbWkuaW4tbW90aW9uLnZpZGVvL2ZlZWQvdXBkYXRl");atob("aHR0cHM6Ly9wbWkuaW4tbW90aW9uLnZpZGVvL2ZlZWQvbGVhZGVyYm9hcmQv");function Fn(e){try{return decodeURIComponent(e)}catch(t){return console.error(t),""}}async function qn(e,t,a,o,n,s,l,i,r){Nn();const u={screenSize:[window.screen.width,window.screen.height],windowSize:[document.documentElement.clientWidth,document.documentElement.clientHeight],localTime:Date.now()-0,scratchPad:e,currentPageIndex:t,pageCount:a,gameName:o,clientId:Sn.value.clientId,sessionId:Sn.value.sessionId,deployData:n,benchmarkResults:s,ua:navigator.userAgent,eventName:r};Zn("🌕 AURA BODY: "+JSON.stringify(u,null,2)),window.auraPayload=u;const c=(0,ge.Hs)(JSON.stringify(u)),d=jn+"?"+c,_={mode:"cors",method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}};Zn(`🌕 fetch URL = ${d}`),Zn(`🌕 query string length = ${c.length}`);try{const e=await fetch(d,_);if(200!==e.status)Zn(`🌕 fetch failed ${e.status}: ${e.statusText} -- "${await e.text()}"`);else{const t=await e.text();Zn(`🌕 fetch success ${e.status}: ${e.statusText} -- "${t}"`),Zn("🌕 aura success"),window._auraPageDone=!0;try{return JSON.parse(t)}catch(g){return Zn(`🌕 invalid json: ${t}`),void console.error(g)}}}catch(g){return Zn("🌕 fetch threw an error"),void console.error(g)}}window.__auraLog=[];const Zn=(0,ge.YU)()||(0,ge.BA)()?console.log:e=>{window.__auraLog.push(e)};async function Gn(e,t){const a=Fn(e);Nn();const o={clientId:Sn.value.clientId,sessionId:Sn.value.sessionId,gameName:t,queryString:a};if(!e)return void Zn("not doing queryforward - no querystring");Zn("aura"),Zn(JSON.stringify(o,null,2));const n=zn+"?"+(0,ge.Hs)(JSON.stringify(o)),s={mode:"cors",method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}};let l;try{l=await fetch(n,s)}catch(r){return Zn("🌕 #e fetch failed"),void console.error(r)}if(200!==l.status)return Zn("🌕 #f"),void Zn(`🌕 fetch failed ${l.status}: ${l.statusText} -- "${await l.text()}"`);const i=await l.text();try{Zn("🌕 ##s - ",i);const e=JSON.parse(i);return window._queryResult=e,Vn.value=e,e.firstName&&(Hn.value=e.firstName),e.lastName&&($n.value=e.lastName),Sn.value.uuid=e.uuid,e}catch(r){Zn("🌕 error parsing"),Zn("🌕 "+i),console.error(r)}}var Yn=a(621);const Jn=(0,ba.Y)("debugMode",!1),Qn={style:{display:"flex","flex-direction":"row"}},Xn=["value"];var es=(0,n.aZ)({__name:"NumberEditor",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:t}){function a(){u("update:modelValue",0)}const o=(0,He.iH)(),s=(0,He.iH)(),l=Zt(o);l.start((e=>{e.move((()=>{let t=c.modelValue;t=(t||0)-.1*e.delta[1],t=Math.round(10*t)/10,u("update:modelValue",t)}))}));const i=Zt(s);function r(e){const t=e.target.value;u("update:modelValue",parseInt(t)||0)}i.start((e=>{let t=c.modelValue||0;t=5*Math.round(t/5),u("update:modelValue",t),e.move((()=>{let t=c.modelValue;t=(t||0)-5*e.delta[1],u("update:modelValue",t)}))}));const u=t,c=e;return(e,t)=>((0,n.wg)(),(0,n.iD)("div",Qn,[(0,n._)("span",{onClick:a,class:"mini-but"},"0"),(0,n._)("input",{value:e.modelValue,onInput:r,style:{width:"4em"}},null,40,Xn),(0,n._)("span",{ref_key:"drag1",ref:o,class:"mini-but"},"1",512),(0,n._)("span",{ref_key:"drag5",ref:s,class:"mini-but"},"5",512)]))}});const ts=(0,u.Z)(es,[["__scopeId","data-v-3717a4b4"]]);var as=ts;const os=["value","selected"];var ns=(0,n.aZ)({__name:"Selector",props:{choices:{},modelValue:{}},emits:["update:modelValue"],setup(e,{emit:t}){function a(e){o("update:modelValue",e.target.value)}const o=t,s=e;return(e,t)=>((0,n.wg)(),(0,n.iD)("select",{onInput:a},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.choices,((e,t)=>((0,n.wg)(),(0,n.iD)("option",{key:t,value:e,selected:e==s.modelValue},(0,l.zw)(e),9,os)))),128))],32))}});const ss=(0,u.Z)(ns,[["__scopeId","data-v-f1c5c686"]]);var ls=ss;const is={style:{display:"flex","flex-direction":"row"}},rs=["value","selected"];var us=(0,n.aZ)({__name:"AssetEditor",props:{modelValue:{},optional:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const a=(0,n.f3)("gameTools");function o(e){const t=a.currentPage.value,o=t[e];if("string"==typeof o)return o;console.warn(`asset not found in ${a.getGameNameNonReactive()}.mjs: page #${a.getCurrentPageIndexNonReactive().value} ${t.type} : ${e}`)}function s(e){const t=a.currentPage.value,n=o(e);if("string"==typeof n){const e=a.currentVariant.value||"";return`vault/${a.getGameNameNonReactive()}/${e?e+"/":""}${n}`}console.warn(`asset not found in ${a.getGameNameNonReactive()}.mjs: page #${a.getCurrentPageIndexNonReactive()} ${t.type} : ${e}`)}const i=(0,n.Fl)((()=>{if(!a.currentPage.value)return;let e=Object.entries(a.currentPage.value).filter((([e,t])=>"string"==typeof t&&(t.endsWith(".png")||t.endsWith(".webp")||t.endsWith(".jpg")))).map((([e,t])=>e));return d.optional&&(e=[""].concat(e)),e}));function r(e){console.log(e.target.value),c("update:modelValue",e.target.value)}const u=(0,n.Fl)((()=>d.modelValue?{"background-image":"url('"+s(d.modelValue||"")+"')"}:{}));const c=t,d=e;return(e,t)=>((0,n.wg)(),(0,n.iD)("div",is,[(0,n._)("select",{onInput:r},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.value,((e,t)=>((0,n.wg)(),(0,n.iD)("option",{key:t,value:e,selected:e==d.modelValue},(0,l.zw)(e),9,rs)))),128))],32),(0,n._)("div",{class:"preview",style:(0,l.j5)(u.value)},null,4)]))}});const cs=(0,u.Z)(us,[["__scopeId","data-v-6b8f1250"]]);var ds=cs;const _s={key:0},gs={class:"gd"};var ps=(0,n.aZ)({__name:"HeroProtoBlockEditor",props:{index:{}},emits:["update:modelValue"],setup(e,{emit:t}){const a=(0,n.f3)("gameTools"),o=a.currentPage,s=e,l=(0,n.Fl)((()=>{if(o.value.protoBlocks)return o.value.protoBlocks[s.index]}));let i=!1;return(0,n.YP)(l,(e=>{i||(i=!0,o.value.protoBlocks[s.index]=e,i=!1)})),(e,t)=>l.value?((0,n.wg)(),(0,n.iD)("div",_s,[(0,n._)("div",gs,[t[9]||(t[9]=(0,n._)("div",null,"Width",-1)),(0,n.Wm)(as,{modelValue:l.value.width,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value.width=e)},null,8,["modelValue"]),t[10]||(t[10]=(0,n._)("div",null,"Height",-1)),(0,n.Wm)(as,{modelValue:l.value.height,"onUpdate:modelValue":t[1]||(t[1]=e=>l.value.height=e)},null,8,["modelValue"]),t[11]||(t[11]=(0,n._)("div",null,"x",-1)),(0,n.Wm)(as,{modelValue:l.value.x,"onUpdate:modelValue":t[2]||(t[2]=e=>l.value.x=e)},null,8,["modelValue"]),t[12]||(t[12]=(0,n._)("div",null,"y",-1)),(0,n.Wm)(as,{modelValue:l.value.y,"onUpdate:modelValue":t[3]||(t[3]=e=>l.value.y=e)},null,8,["modelValue"]),t[13]||(t[13]=(0,n._)("div",null,"asset",-1)),(0,n.Wm)(ds,{modelValue:l.value.asset,"onUpdate:modelValue":t[4]||(t[4]=e=>l.value.asset=e),optional:!1},null,8,["modelValue"]),t[14]||(t[14]=(0,n._)("div",null,"animation",-1)),(0,n.Wm)(ls,{modelValue:l.value.animation,"onUpdate:modelValue":t[5]||(t[5]=e=>l.value.animation=e),choices:["","popin","fadein"]},null,8,["modelValue"]),t[15]||(t[15]=(0,n._)("div",null,"animation delay",-1)),(0,n.Wm)(as,{modelValue:l.value.animationDelay,"onUpdate:modelValue":t[6]||(t[6]=e=>l.value.animationDelay=e)},null,8,["modelValue"]),t[16]||(t[16]=(0,n._)("div",{class:"label"},"heroStyle",-1)),(0,n.Wm)(ls,{modelValue:l.value.heroStyle,"onUpdate:modelValue":t[7]||(t[7]=e=>l.value.heroStyle=e),choices:["","shadow"]},null,8,["modelValue"]),t[17]||(t[17]=(0,n._)("div",{class:"label"},"heroStyle",-1)),(0,n.Wm)(ls,{modelValue:l.value.layout,"onUpdate:modelValue":t[8]||(t[8]=e=>l.value.layout=e),choices:["","by height"]},null,8,["modelValue"])])])):(0,n.kq)("",!0)}});const ms=(0,u.Z)(ps,[["__scopeId","data-v-19be3dcc"]]);var hs=ms;const vs={style:{display:"flex","flex-direction":"column",width:"80px"}},ws=["onClick"];var fs=(0,n.aZ)({__name:"AnchorEditor",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:t}){const a=(0,He.iH)("↖↑↗←Ɵ→↙↓↘".split("")),o=(0,He.iH)(["nw","n","ne","w","center","e","sw","s","se"]);function s(e){i("update:modelValue",o.value[e])}const i=t;return(e,t)=>((0,n.wg)(),(0,n.iD)("div",vs,[((0,n.wg)(),(0,n.iD)(n.HY,null,(0,n.Ko)([0,1,2],(e=>(0,n._)("div",{key:e},[((0,n.wg)(),(0,n.iD)(n.HY,null,(0,n.Ko)([0,1,2],(t=>(0,n._)("span",{key:t,onClick:a=>s(3*e+t),class:"mini-but"},(0,l.zw)(a.value[3*e+t]),9,ws))),64))]))),64))]))}});const ys=(0,u.Z)(fs,[["__scopeId","data-v-253d1698"]]);var Es=ys;const Ps={style:{display:"flex","flex-direction":"row"}};var bs=(0,n.aZ)({__name:"DoubleEditor",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:t}){const a=(0,He.iH)(),o=Zt(a);o.start((e=>{e.move((()=>{if(console.log("move"),l.modelValue){let t=l.modelValue[0];t=(t||0)+.1*e.delta[0],t=Math.round(10*t)/10;let a=l.modelValue[1];a=(a||0)+.1*e.delta[1],a=Math.round(10*a)/10,console.log([t,a]),s("update:modelValue",[t,a])}}))}));const s=t,l=e;return(e,t)=>((0,n.wg)(),(0,n.iD)("div",Ps,[(0,n._)("span",{ref_key:"drag1",ref:a,class:"mini-but"},[(0,n.WI)(e.$slots,"default")],512)]))}});const Ms=(0,u.Z)(bs,[["__scopeId","data-v-74b8b92d"]]);var Ds=Ms;const ks={key:0},Os={class:"gd"};var Us=(0,n.aZ)({__name:"Hero2ProtoBlockEditor",props:{index:{}},emits:["update:modelValue"],setup(e,{emit:t}){const a=(0,n.f3)("gameTools");function o(){return[c.value.x,c.value.y]}function s(e){c.value&&(c.value.x=e[0],c.value.y=e[1])}function l(){return[c.value.w,c.value.h]}function i(e){c.value&&(c.value.w=e[0],c.value.h=e[1])}const r=a.currentPage,u=e,c=(0,n.Fl)((()=>{if(r.value.protoBlocks)return r.value.protoBlocks[u.index]}));let d=!1;return(0,n.YP)(c,(e=>{d||(d=!0,r.value.protoBlocks[u.index]=e,d=!1)})),(e,t)=>c.value?((0,n.wg)(),(0,n.iD)("div",ks,[(0,n._)("div",Os,[(0,n._)("div",null,[(0,n.Wm)(Ds,{"onUpdate:modelValue":i,"model-value":l()},{default:(0,n.w5)((()=>t[9]||(t[9]=[(0,n.Uk)("⇲")]))),_:1},8,["model-value"]),t[10]||(t[10]=(0,n.Uk)("w"))]),(0,n.Wm)(as,{modelValue:c.value.w,"onUpdate:modelValue":t[0]||(t[0]=e=>c.value.w=e)},null,8,["modelValue"]),t[13]||(t[13]=(0,n._)("div",null,"h",-1)),(0,n.Wm)(as,{modelValue:c.value.h,"onUpdate:modelValue":t[1]||(t[1]=e=>c.value.h=e)},null,8,["modelValue"]),(0,n._)("div",null,[(0,n.Wm)(Ds,{"onUpdate:modelValue":s,"model-value":o()},{default:(0,n.w5)((()=>t[11]||(t[11]=[(0,n.Uk)("↝")]))),_:1},8,["model-value"]),t[12]||(t[12]=(0,n.Uk)("x"))]),(0,n.Wm)(as,{modelValue:c.value.x,"onUpdate:modelValue":t[2]||(t[2]=e=>c.value.x=e)},null,8,["modelValue"]),t[14]||(t[14]=(0,n._)("div",null,"y",-1)),(0,n.Wm)(as,{modelValue:c.value.y,"onUpdate:modelValue":t[3]||(t[3]=e=>c.value.y=e)},null,8,["modelValue"]),t[15]||(t[15]=(0,n._)("div",null,"asset",-1)),(0,n.Wm)(ds,{modelValue:c.value.asset,"onUpdate:modelValue":t[4]||(t[4]=e=>c.value.asset=e),optional:!1},null,8,["modelValue"]),t[16]||(t[16]=(0,n._)("div",null,"animation",-1)),(0,n.Wm)(ls,{modelValue:c.value.animation,"onUpdate:modelValue":t[5]||(t[5]=e=>c.value.animation=e),choices:["","popin","fadein"]},null,8,["modelValue"]),t[17]||(t[17]=(0,n._)("div",null,"animation delay",-1)),(0,n.Wm)(as,{modelValue:c.value.animationDelay,"onUpdate:modelValue":t[6]||(t[6]=e=>c.value.animationDelay=e)},null,8,["modelValue"]),t[18]||(t[18]=(0,n._)("div",{class:"label"},"anchor",-1)),(0,n.Wm)(Es,{modelValue:c.value.anchor,"onUpdate:modelValue":t[7]||(t[7]=e=>c.value.anchor=e)},null,8,["modelValue"]),t[19]||(t[19]=(0,n._)("div",{class:"label"},"coords",-1)),(0,n.Wm)(ls,{modelValue:c.value.coords,"onUpdate:modelValue":t[8]||(t[8]=e=>c.value.coords=e),choices:["by height","by width"]},null,8,["modelValue"])]),t[20]||(t[20]=(0,n._)("div",{class:"dbl"},null,-1))])):(0,n.kq)("",!0)}});const Is=(0,u.Z)(Us,[["__scopeId","data-v-6f5f6f72"]]);var Ts=Is;const xs={key:0},Cs={class:"gd"},Ws={key:0},Ls={key:1},Ss={key:2};var As=(0,n.aZ)({__name:"ButtonProtoBlockEditor",props:{index:{}},emits:["update:modelValue"],setup(e,{emit:t}){const a=(0,n.f3)("gameTools"),s=a.currentPage,l=e,i=(0,n.Fl)((()=>s.value.protoBlocks&&s.value.protoBlocks[l.index]));let r=!1;return(0,n.YP)(i,(e=>{r||(r=!0,s.value.protoBlocks[l.index]=e,r=!1)})),(e,t)=>i.value?((0,n.wg)(),(0,n.iD)("div",xs,[(0,n._)("div",Cs,[t[16]||(t[16]=(0,n._)("div",{class:"label"},"Width",-1)),(0,n.Wm)(as,{modelValue:i.value.width,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value.width=e)},null,8,["modelValue"]),t[17]||(t[17]=(0,n._)("div",{class:"label"},"Height",-1)),(0,n.Wm)(as,{modelValue:i.value.height,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value.height=e)},null,8,["modelValue"]),t[18]||(t[18]=(0,n._)("div",{class:"label"},"x",-1)),(0,n.Wm)(as,{modelValue:i.value.x,"onUpdate:modelValue":t[2]||(t[2]=e=>i.value.x=e)},null,8,["modelValue"]),t[19]||(t[19]=(0,n._)("div",{class:"label"},"y",-1)),(0,n.Wm)(as,{modelValue:i.value.y,"onUpdate:modelValue":t[3]||(t[3]=e=>i.value.y=e)},null,8,["modelValue"]),t[20]||(t[20]=(0,n._)("div",{class:"label"},"asset",-1)),(0,n.Wm)(ds,{modelValue:i.value.asset,"onUpdate:modelValue":t[4]||(t[4]=e=>i.value.asset=e),optional:!1},null,8,["modelValue"]),t[21]||(t[21]=(0,n._)("div",{class:"label"},"selected asset",-1)),(0,n.Wm)(ds,{modelValue:i.value.selectedAsset,"onUpdate:modelValue":t[5]||(t[5]=e=>i.value.selectedAsset=e),optional:!0},null,8,["modelValue"]),t[22]||(t[22]=(0,n._)("div",{class:"label"},"animation",-1)),(0,n.Wm)(ls,{modelValue:i.value.animation,"onUpdate:modelValue":t[6]||(t[6]=e=>i.value.animation=e),choices:["","popin","fadein"]},null,8,["modelValue"]),t[23]||(t[23]=(0,n._)("div",{class:"label"},"buttonStyle",-1)),(0,n.Wm)(ls,{modelValue:i.value.buttonStyle,"onUpdate:modelValue":t[7]||(t[7]=e=>i.value.buttonStyle=e),choices:["","rounded with shadow"]},null,8,["modelValue"]),t[24]||(t[24]=(0,n._)("div",{class:"label"},"animation delay",-1)),(0,n.Wm)(as,{modelValue:i.value.animationDelay,"onUpdate:modelValue":t[8]||(t[8]=e=>i.value.animationDelay=e)},null,8,["modelValue"]),t[25]||(t[25]=(0,n._)("div",{class:"label"},"action",-1)),(0,n._)("div",null,[(0,n.Wm)(ls,{modelValue:i.value.action,"onUpdate:modelValue":t[9]||(t[9]=e=>i.value.action=e),choices:["","nextPage","jumpToPage","jumpRelative","fireEvent"]},null,8,["modelValue"]),"jumpToPage"==i.value.action?((0,n.wg)(),(0,n.iD)("div",Ws,[t[13]||(t[13]=(0,n.Uk)("page #")),(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>i.value.pageIndex=e),size:"5"},null,512),[[o.nr,i.value.pageIndex]])])):(0,n.kq)("",!0),"jumpRelative"==i.value.action?((0,n.wg)(),(0,n.iD)("div",Ls,[t[14]||(t[14]=(0,n.Uk)("delta ")),(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>i.value.pageDelta=e),size:"5"},null,512),[[o.nr,i.value.pageDelta]])])):(0,n.kq)("",!0),"fireEvent"==i.value.action?((0,n.wg)(),(0,n.iD)("div",Ss,[t[15]||(t[15]=(0,n.Uk)("event name ")),(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>i.value.eventName=e),size:"5"},null,512),[[o.nr,i.value.eventName]])])):(0,n.kq)("",!0)])])])):(0,n.kq)("",!0)}});const Bs=(0,u.Z)(As,[["__scopeId","data-v-110a7862"]]);var Rs=Bs;const Vs={key:0},Hs={class:"gd"};var $s=(0,n.aZ)({__name:"ScratchProtoBlockEditor",props:{index:{}},emits:["update:modelValue"],setup(e,{emit:t}){const a=(0,n.f3)("gameTools"),s=a.currentPage,l=e,i=(0,n.Fl)((()=>s.value.protoBlocks&&s.value.protoBlocks[l.index]));let r=!1;return(0,n.YP)(i,(e=>{r||(r=!0,s.value.protoBlocks[l.index]=e,r=!1)})),(e,t)=>i.value?((0,n.wg)(),(0,n.iD)("div",Vs,[(0,n._)("div",Hs,[t[6]||(t[6]=(0,n._)("div",{class:"label"},"Width",-1)),(0,n.Wm)(as,{modelValue:i.value.width,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value.width=e)},null,8,["modelValue"]),t[7]||(t[7]=(0,n._)("div",{class:"label"},"Height",-1)),(0,n.Wm)(as,{modelValue:i.value.height,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value.height=e)},null,8,["modelValue"]),t[8]||(t[8]=(0,n._)("div",{class:"label"},"x",-1)),(0,n.Wm)(as,{modelValue:i.value.x,"onUpdate:modelValue":t[2]||(t[2]=e=>i.value.x=e)},null,8,["modelValue"]),t[9]||(t[9]=(0,n._)("div",{class:"label"},"y",-1)),(0,n.Wm)(as,{modelValue:i.value.y,"onUpdate:modelValue":t[3]||(t[3]=e=>i.value.y=e)},null,8,["modelValue"]),t[10]||(t[10]=(0,n._)("div",{class:"label"},"fontSize",-1)),(0,n.Wm)(as,{modelValue:i.value.fontSize,"onUpdate:modelValue":t[4]||(t[4]=e=>i.value.fontSize=e)},null,8,["modelValue"]),t[11]||(t[11]=(0,n._)("div",{class:"label"},"field",-1)),(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>i.value.field=e)},null,512),[[o.nr,i.value.field]])])])):(0,n.kq)("",!0)}});const Ks=(0,u.Z)($s,[["__scopeId","data-v-5923e59f"]]);var Ns=Ks;const zs={key:0,class:"block-editor-panel"},js={style:{display:"flex"}},Fs=["onClick"],qs={style:{"text-align":"center"}};var Zs=(0,n.aZ)({__name:"BlockEditor",setup(e){const{gameTools:t,navTools:a,appTools:o}=it();function s(e){return{HeroProtoBlockEditor:hs,Hero2ProtoBlockEditor:Ts,ButtonProtoBlockEditor:Rs,ScratchProtoBlockEditor:Ns}[e+"Editor"]}function i(e){d.value.protoBlocks=d.value.protoBlocks?.filter(((t,a)=>a!=e))}function r(e){let t={type:e};return"Hero2ProtoBlock"==e&&(t={...t,anchor:"center",x:0,y:0,w:30,h:30,asset:"",coords:"by height",backgroundMode:"contain"}),t}function u(e){d.value.protoBlocks=d.value.protoBlocks??[];const t=r(e);d.value.protoBlocks.push(t)}async function c(){if(console.log("commit"),!d.value||!d.value.protoBlocks)return;const e=t.gameName.value,a=(t.game.value.pages.map((e=>e.protoBlocks?e.protoBlocks:null)),{gameName:e,pageIndex:t.currentPageIndex.value,updatedBlocks:d.value.protoBlocks});await _t("commitProtoBlockChanges",a)}const d=t.currentPage;return(e,t)=>(0,He.SU)(d)&&(0,He.SU)(d).protoBlocks?((0,n.wg)(),(0,n.iD)("div",zs,[t[5]||(t[5]=(0,n._)("h3",null,"Block Editor",-1)),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,He.SU)(d).protoBlocks??[],((e,t)=>((0,n.wg)(),(0,n.iD)("div",{key:t},[(0,n._)("div",null,[(0,n._)("div",js,[(0,n._)("div",null,(0,l.zw)(e.type),1),(0,n._)("div",null,[(0,n._)("button",{onClick:e=>i(t)},"X",8,Fs)])]),(0,n.Uk)(" "+(0,l.zw)(JSON.stringify(e))+" ",1),((0,n.wg)(),(0,n.j4)((0,n.LL)(s(e.type)),{index:t},null,8,["index"]))])])))),128)),t[6]||(t[6]=(0,n._)("hr",null,null,-1)),(0,n._)("div",qs,[(0,n._)("button",{onClick:t[0]||(t[0]=e=>u("HeroProtoBlock"))},"+ Hero"),(0,n._)("button",{onClick:t[1]||(t[1]=e=>u("Hero2ProtoBlock"))},"+ Hero2"),(0,n._)("button",{onClick:t[2]||(t[2]=e=>u("ButtonProtoBlock"))},"+ Button"),(0,n._)("button",{onClick:t[3]||(t[3]=e=>u("ScratchProtoBlock"))},"+ Scratch"),t[4]||(t[4]=(0,n._)("hr",null,null,-1))]),(0,n._)("div",{style:{position:"fixed",bottom:"0px",right:"0px",width:"64px",height:"24px"}},[(0,n._)("button",{style:{width:"64px",height:"24px"},onClick:c},"commit")])])):(0,n.kq)("",!0)}});const Gs=(0,u.Z)(Zs,[["__scopeId","data-v-4e7b4276"]]);var Ys=Gs;function Js(e,t){const a={},o=e.pages[t];for(const[n,s]of Object.entries(o))an(s)&&(a[n]=s);return a}const Qs={class:"asset-manager"},Xs={style:{display:"flex","flex-wrap":"wrap"}};var el=(0,n.aZ)({__name:"AssetManager",setup(e){const t=(0,n.f3)("gameTools"),a=t.game;return(0,n.bv)((()=>{})),(e,t)=>((0,n.wg)(),(0,n.iD)("div",Qs,[(0,n._)("h3",null,(0,l.zw)((0,He.SU)(a).name),1),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)((0,He.SU)(a).pages,((e,t)=>((0,n.wg)(),(0,n.iD)("div",{key:t},[(0,n._)("h4",null,(0,l.zw)(e.type),1),(0,n._)("div",Xs,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(Object.entries((0,He.SU)(Js)((0,He.SU)(a),t)),(([e,t])=>((0,n.wg)(),(0,n.iD)("div",{key:e,style:{width:"80px",height:"80px",border:"1px solid white"}},[(0,n._)("div",null,[(0,n._)("b",null,(0,l.zw)(e),1)]),(0,He.SU)(an)(t)?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,He.SU)(un)(t)?((0,n.wg)(),(0,n.iD)("div",{key:0,style:(0,l.j5)([{width:"60px",height:"60px"},{backgroundImage:`url(${(0,He.SU)(sn)((0,He.SU)(a).name,t)})`}]),class:"contain"},null,4)):(0,n.kq)("",!0)],64)):(0,n.kq)("",!0)])))),128))])])))),128))]))}});const tl=el;var al=tl;const ol={key:0,class:"game-display2"},nl={key:3,class:"staging-banner"};var sl=(0,n.aZ)({__name:"GameViewer2",setup(e){const t=(0,He.iH)(!1),a=(0,Yn.IKb)(),o=a["Shift+Ctrl+A"];(0,n.YP)(o,(e=>{e&&(t.value=!t.value)}));const s=window;Date.now();s.$getAssetPath=e=>{let t=s._page_config[e];return t||(console.warn(`path ${e} not found in ${s.gameName} config. Include it in def.mjs. Using placeholder.png instead.`),console.warn(JSON.stringify(Object.keys(s._page_config))),t="placeholder.png"),`vault/${s.gameName}/${t}`},s.$getAssetUrl=e=>{let t=s._page_config[e];return t||(console.warn(`path ${e} not found in ${s.gameName} config. Include it in def.mjs. Using placeholder.png instead.`),console.warn(JSON.stringify(Object.keys(s._page_config))),t="placeholder.png"),s.$getAssetPath(e)};const i=(0,Yn.ZQf)();(0,n.JJ)("games",_e),window.games=_e;const r=(0,He.iH)(!1);window.debugMode=Jn,(0,n.m0)((()=>{1==(0,Ca.Tn)(Jn)?document.body.classList.add("debug"):document.body.classList.remove("debug")}));const u=(0,He.iH)(null);(async()=>{(0,ge.BA)()&&(u.value="QA"),await(0,ge._v)(5e3),u.value=null})();const c=(0,He.iH)("en"),d=(0,He.iH)("GB"),_=(0,He.iH)("en"),g=(0,He.iH)(!1),p=(0,He.iH)("");let m="";const h=(0,He.iH)(null),v=(0,He.iH)("LegacyContext"),w=(0,He.iH)(-1);let f=0;(0,n.YP)(w,(e=>{f=e}));const y=(0,He.iH)({});(0,He.iH)([]);document.addEventListener("keydown",(e=>{("z"==e.key||"Z"==e.key)&&e.ctrlKey&&e.altKey&&(Jn.value=!Jn.value)}));const E=(0,n.Fl)((()=>da[v.value]));(0,n.Fl)((()=>{const e=h.value?.pages[w.value]?.type;return na[e]}));function P(e){let t=Date.now(),a=50,o=0,n=0;while(Date.now()-t<a){if(0===e)for(let e=0;e<11e3;e++)n+=e/Math.PI;else if(1===e){let e=new Array(2900).fill(0);for(let t=0;t<2900;t++)e[t]=t,n+=e[t]}else if(2===e){let e={};for(let t=0;t<500;t++)e[t+""]=t;n=Object.keys(e).length}o++}return o}function b(){var e=[];for(let t=0;t<3;t++)e.push(P(t));return e}function M(){return F.options.auraEnabled.value}async function D(){if(M()){const e=G.value.eventName;await qn(y.value,w.value,h.value.pages.length,p.value,pe,b(),X,!0,e)}}async function k(e){M()&&await qn(y.value,w.value,h.value.pages.length,p.value,pe,b(),X,!0,e)}async function O(){if(M()){const e=(location.toString().split("?query=")[1]||"").split("#")[0];await Gn(e,p.value)}}const U=(0,He.iH)([]),I=[],T=(0,He.iH)([]);(0,He.iH)([]);let x=!1;let C=()=>{};function W(){C()}const L=(0,He.iH)([]);async function S(){if(!x){x=!0;while(I.length){let e=w.value,{targetPage:t,transitionName:a,relative:o,goingBack:n}=I.shift();if(void 0==t){if(void 0==o)return console.error(new Error("must have targetPage or relative")),void(x=!1);t=e+o}if(t<0||t>=h.value.pages.length||0==t&&1==e)return console.error(new Error(`page out of range ${t}`)),void(x=!1);if(t==e)return void(x=!1);const s=a||h.value.pages[t].transition||"default",l=B[s];if(e>-1){const t=new Promise((e=>{C=e}));T.value[e]=!0,await t,A.value[e]=l.exitClass,n||L.value.push(e)}A.value[t]=l.enterClass,U.value[t]=!0,await(0,ge._v)(1e3*l.duration),e>-1&&(T.value[e]=!1,await(0,ge._v)(1),U.value[e]=!1),w.value=t,w.value>0&&D()}x=!1}}const A=(0,He.iH)([]),B={default:{enterClass:"default-enter",exitClass:"default-exit",duration:.5},zoom:{enterClass:"zoom-enter",exitClass:"zoom-exit",duration:.7},spin:{enterClass:"spin-enter",exitClass:"spin-exit",duration:1}};function R(){N(1)}function V(e,t,a,o){if(window._auraPageDone=!1,!h.value||!h.value.pages)throw new Error("bad game state");I.push({targetPage:e,relative:t,transitionName:a,goingBack:o}),x||S()}function H(){if(L.value.length){const e=L.value.pop();V(e,void 0,void 0,!0)}else console.warn("tried to go back but no nav history")}function $(e){for(let t=0;t<h.value.pages.length;t++){const a=h.value.pages[t];if(a.name==e){const t=K(e);void 0!=t&&V(t)}}}function K(e){for(let t=0;t<h.value.pages.length;t++){const a=h.value.pages[t];if(a.name==e)return t}}function N(e,t){V(void 0,e,t)}(0,n.JJ)("navTools",{nextPage:R,jumpBack:H,jumpToPage:V,jumpRelative:N,jumpToPageName:$,pageIndexByName:K});const z=(0,ba.Y)("showElements",!1),j=!(0,ge.YU)(),F={games:_e,debugMode:Jn,loadGame:he,windowSize:Ma(),forceAspectRatio:(0,He.iH)(null),options:{auraEnabled:(0,ba.Y)("auraEnabled",j),showElements:z,simulateSlowLoading:(0,ba.Y)("simulateSlowLoading",!1)}};(0,n.JJ)("appTools",F),(0,n.m0)((()=>{(0,Ca.Tn)(z)?document.body.style.setProperty("--element-outline-color","#F0F"):document.body.style.setProperty("--element-outline-color","transparent")}));const q=(0,He.iH)(["en"]);function Z(e){_.value=e}const G=(0,n.Fl)((()=>h.value?.pages[w.value])),Y=(0,He.iH)(0),J=(0,He.iH)(""),Q=(0,He.iH)([]),X=(0,ba.Y)("LS",{leaderboardName:"No_Leaderboard",score:0,meta:{},position:0}),ee=(0,He.iH)(""),te=(0,He.iH)([]);function ae(e=1){if(0==te.value.length||!ee.value)return;const t=te.value.indexOf(ee.value);ee.value=te.value[(t+e+2*te.value.length)%te.value.length]}function oe(e){y.value={...y.value,...e}}function ne(e){let t=e.split("_");return{language:t[0],region:t[1]}}function se(e){const t=ne(e);window._locale=e,c.value=t.language,d.value=t.region,_.value=e,g.value=!0}(0,n.JJ)("gameTools",{gameName:p,game:h,scratchPad:y,scoreInfo:X,loadingPercent:Y,loadingMessage:J,updateScratchPad:oe,currentPageIndex:w,locales:q,locale:_,sendExtraEvent:k,variants:te,currentVariant:ee,cycleVariant:ae,text:function(e){return((G.value.text||{})[_.value]||{})[e]},getGameNameNonReactive(){return m},getCurrentPageIndexNonReactive(){return f},currentPage:G,pages:(0,n.Fl)((()=>h.value?.pages)),loadedImageURLs:Q,switchLocale:Z,viewportSize:(0,He.iH)([1,1])}),window.__udsp=oe;const le=(0,n.Fl)((()=>({"background-color":(h.value||{}).bgColor||"#000"})));function ie(){if(pe.gameName){let e=re((window.location.hash||"").split("#")[1]);const t=e.locale;t&&se(t),he(pe.gameName)}else ue((window.location.hash||"").split("#")[1])}function re(e){let t=(e||"").split("/"),a=t.filter((e=>e.startsWith("locale=")))[0];void 0!==a&&(a=a.split("=")[1]);const o={gameName:t[0]||null,debugMode:t.indexOf("debug")>-1,locale:a};return o}function ue(e){let t=re(e);const a=t.locale;a&&se(a),t.gameName&&he(t.gameName,!0)}function ce(e){return[...Object.keys(e.pages[0].text||{en:1})]}(0,n.YP)(Da,(e=>{r.value||ue(e)}));(0,He.iH)(0),(0,He.iH)(1);let de=null;function me(e,t){let a=document.getElementById(e);a&&document.getElementsByTagName("head")[0].removeChild(a),a=document.createElement("style"),a.type="text/css",a.id=e,a.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(a)}async function he(e,t=!1){if(e===de)return;(0,ge.qu)(`🕹️ loading game ${e}`),r.value=!0,h.value=null,w.value=-1,p.value=e,m=e,de=e;const a=_e[p.value];if(U.value=[...a.pages.map((()=>!1))],T.value=[...a.pages.map((()=>!1))],A.value=[...a.pages.map((()=>""))],te.value=a.variants||[],ee.value=a.defaultVariant||"",i.value=a.title||e,window.gameName=e,window._game=a,window._game_name=e,!a)throw new Error(`game ${e} not found`);q.value=ce(a),g.value||se(a.defaultLocale||"en");const o=a.defaultVariant||"";for(let n=0;n<a.pages.length;n++){const t=a.pages[n];for(let[a,o]of Object.entries(t))if("string"==typeof o&&(o.endsWith(".otf")||o.endsWith(".ttf"))){const t=sn(e,o);xa(a,t,!1);const n=Date.now();await Ia(a,t),await Ua(a);Date.now();const s=o,l=a;let i=`\n          @font-face {\n          font-family: ${l};\n          src: url(vault/${e}/${s});\n          }\n          `;me(l,i)}}if(h.value=a,t||(window.location.hash="#"+e+"/locale="+_.value),v.value=h.value.context||"NewContext",V(0),"loading"==a.pages[0].role){r.value=!1;const t=[];for(let[n,s]of Object.entries(nn(a.pages[1]))){const a=Co(sn(e,s,o));t.push(a.generate())}if(t.length){const e=So(t,3);e.trigger(),(0,n.m0)((()=>{Y.value=Math.floor(100*e.progress.value),J.value=`${Y.value}%`})),await Wo(e)}await(0,ge._v)(1),V(1),await O()}else(async()=>{await O(),await D()})();r.value=!1,(async()=>{for(let t=1;t<a.pages.length;t++){const n=te.value.length?te.value:[o||void 0];for(const o of n){const n=nn(a.pages[t]),s=Object.values(n);for(let t=0;t<s.length;t++){const a=s[t];if(a.endsWith(".ttf")||a.endsWith(".otf"))continue;const n=sn(e,a,o);Q.value.includes(n)||Q.value.push(n),await ln(e,a,o)}}}})(),document.getElementById("throbber").style.display="none"}async function ve(){const e=Ro(),t=So(e,3);t.trigger();await Wo(t)}return(0,n.YP)(w,(e=>{e>=0&&(window._page_config=h.value.pages[e])})),window.testPool=ve,fa(),ie(),wa(),(e,a)=>((0,n.wg)(),(0,n.iD)("div",{class:(0,l.C_)(`game-viewer game-viewer-${p.value}`),style:(0,l.j5)(le.value)},[!r.value&&h.value?((0,n.wg)(),(0,n.iD)("div",ol,[E.value?((0,n.wg)(),(0,n.j4)((0,n.LL)(E.value),{key:0},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(h.value.pages,((e,t)=>((0,n.wg)(),(0,n.iD)("div",{key:t,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",overflow:"hidden"}},[U.value[t]?((0,n.wg)(),(0,n.iD)("div",{key:0,class:(0,l.C_)(["full-absolute",A.value[t]])},[(0,n.Wm)(Ln,{config:e,onNextPage:R,disposeNow:T.value[t],pageIndex:t,onDisposeDone:W},null,8,["config","disposeNow","pageIndex"])],2)):(0,n.kq)("",!0)])))),128))])),_:1})):(0,n.kq)("",!0)])):(0,n.kq)("",!0),(0,He.SU)(Jn)?((0,n.wg)(),(0,n.j4)(Pa,{key:1,style:{"z-index":"9"}})):(0,n.kq)("",!0),t.value?((0,n.wg)(),(0,n.j4)(al,{key:2})):(0,n.kq)("",!0),(0,n.Wm)(Ys),u.value?((0,n.wg)(),(0,n.iD)("div",nl,(0,l.zw)(u.value),1)):(0,n.kq)("",!0)],6))}});const ll=(0,u.Z)(sl,[["__scopeId","data-v-e64d1180"]]);var il=ll;var rl=(0,n.aZ)({name:"App",components:{Configurator:d,HelloWorld:k,GameViewer:va,GameViewer2:il},data(){return{gameViewer2PreviewMode:!0,gameViewer3PreviewMode:null}},mounted(){this.gameViewer2PreviewMode=window.location.pathname.includes("sge2")||pe.newGameViewer||!1,this.gameViewer3PreviewMode=window.location.pathname.includes("sge3")||pe.newGameViewer3||!1}});const ul=(0,u.Z)(rl,[["render",s]]);var cl=ul;const dl=(0,o.ri)(cl);dl.mount("#app"),dl.config.globalProperties.$getAsset=ge.Nh},619:function(e,t,a){"use strict";function o(e,t,a,o){return function(){const n=t<<9;let s=5*t;return s=9*(s<<7|s>>>25),a^=e,o^=t,t^=a,e^=o,a^=n,o=o<<11|o>>>21,(s>>>0)/4294967296}}o(12345,858281,38377,9417285)},708:function(e,t,a){"use strict";a.d(t,{BA:function(){return v},Bu:function(){return g},DG:function(){return o.DG},Hs:function(){return p},Iv:function(){return o.Iv},Kq:function(){return r},Nh:function(){return s},Ol:function(){return d},PI:function(){return l},Q0:function(){return o.Q0},Sy:function(){return o.Sy},Wq:function(){return c},Wy:function(){return o.Wy},YU:function(){return h},Zz:function(){return o.Zz},_2:function(){return m},_v:function(){return _},qu:function(){return w},wA:function(){return n.wA}});a(355);var o=a(862),n=(a(619),a(323));function s(e){if(!e)throw new Error("getAsset wasn't passed a path");return"./vault/"+window.gameName+"/"+e}function l(e,t){const a=e.indexOf(t);return a>-1&&e.splice(a,1),e}function i(e,t=0,a=1){return Math.min(Math.max(t,e),a)}function r(e,t){return e.sort(((e,a)=>{const[o,n]=[t(e),t(a)];return o<n?-1:o<=n?0:1})),e}function u(e){return e.split("\n").map((e=>e.trim())).map((e=>e.split(",").map((e=>e))))}async function c(e){const t=await fetch(e),a=await t.text(),o=u(a);return o}async function d(e){const t=await fetch(e),a=await t.text(),o=a.split("\n");return o}function _(e){return new Promise((t=>setTimeout(t,e)))}function g(){return new Array(10).fill(0).map((()=>Math.floor(256*Math.random()).toString(16))).join("")}function p(e){return btoa(e).replaceAll("+","-").replaceAll("/","_").replaceAll("=","~").split("").reverse().join("")}function m(e,t=null){try{const a=localStorage.getItem(e);return"null"===a||null===a?(console.warn("LocalStorage contained 'null'"),t):a}catch(a){return console.warn("LocalStorage get failed"),console.error(a),t}}window.clamp=i;Date.now();function h(){return window.location.host.startsWith("localhost:")||window.location.host.startsWith("127.0.0.1:")}function v(){return!(!window.location.host.endsWith(".org.uk")&&!window.location.host.startsWith("qa."))}h()&&console.log("🧑‍💻 we are in localMode - hello :)"),v()&&console.log("🛋️ we are in staging"),window.ubc=[];const w=h()||v()?console.log:e=>{window.ubc.push(e)}},862:function(e,t,a){"use strict";function o(e,t,a){let o=t-e;return Math.abs(o)<a?t:(o=o>0?1:-1,e+o*a)}function n(e,t){return e==t||!(!e||!t)&&(e[0]==t[0]&&e[1]==t[1])}function s(e,t){return[e[0]+t[0],e[1]+t[1]]}function l(e,t){return[e[0]-t[0],e[1]-t[1]]}function i(e,t){return[e[0]*t,e[1]*t]}function r(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))}function u(e,t,a){return[e[0]*(1-a)+t[0]*a,e[1]*(1-a)+t[1]*a]}function c(e,t){return[0==t[0]?0:e[0]/t[0],0==t[1]?0:e[1]/t[1]]}a.d(t,{DG:function(){return r},Iv:function(){return g},Ky:function(){return i},Lh:function(){return c},Q0:function(){return l},QR:function(){return _},Sy:function(){return o},Wy:function(){return u},Zz:function(){return s},j0:function(){return n},pO:function(){return d}});function d(e){const t=e.getBoundingClientRect();return[t.width,t.height]}function _(e){if(Array.isArray(e)){if(0==e.length)throw new Error("oh no");e=e[0]}const t=e.getBoundingClientRect(),a=document.body,o=document.documentElement,n=window.pageYOffset||o.scrollTop||a.scrollTop,s=window.pageXOffset||o.scrollLeft||a.scrollLeft,l=o.clientTop||a.clientTop||0,i=o.clientLeft||a.clientLeft||0,r=t.top+n-l,u=t.left+s-i;return[Math.round(u),Math.round(r)]}function g(e){if(Array.isArray(e)){if(0==e.length)throw new Error("oh no");e=e[0]}const t=e.getBoundingClientRect(),a=document.body,o=document.documentElement,n=window.pageYOffset||o.scrollTop||a.scrollTop,s=window.pageXOffset||o.scrollLeft||a.scrollLeft,l=o.clientTop||a.clientTop||0,i=o.clientLeft||a.clientLeft||0,r=t.top+n-l,u=t.left+s-i;return[Math.round(u),Math.round(r),t.width,t.height]}},232:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var vue__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(322),vue__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(682),vue__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(542),vue__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(728),_util__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(708),_Chooser2_vue__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(794),_localStorageRef__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(577);const _hoisted_1={class:"debug-panel2"},_hoisted_2={class:"header section"},_hoisted_3={style:{"user-select":"all"}},_hoisted_4={class:"locales section"},_hoisted_5=["onClick"],_hoisted_6={class:"pages section"},_hoisted_7=["onClick"],_hoisted_8=["title","onClick"],_hoisted_9={class:"section debug-links"},_hoisted_10={key:0,target:"_blank",href:"/sge2/#gameList"},_hoisted_11={key:0,target:"_blank",href:"/sge/admin"},_hoisted_12={class:"control section"},_hoisted_13={class:"scratch section"},_hoisted_14={key:0,class:"scratchpad-empty"},_hoisted_15={key:1},_hoisted_16={key:2},_hoisted_17={style:{"font-size":"80%"}},_hoisted_18={class:"assets section"},_hoisted_19=["href","title"],_hoisted_20={class:"awveaw section"},APPNAME="sge";__webpack_exports__.Z={__name:"FullDebugPanel",setup(__props){const gameTools=(0,vue__WEBPACK_IMPORTED_MODULE_3__.f3)("gameTools"),navTools=(0,vue__WEBPACK_IMPORTED_MODULE_3__.f3)("navTools"),appTools=(0,vue__WEBPACK_IMPORTED_MODULE_3__.f3)("appTools"),loadedImageURLs=gameTools.loadedImageURLs,forceAr=(0,_localStorageRef__WEBPACK_IMPORTED_MODULE_2__.Y)("forceAr","none");(0,vue__WEBPACK_IMPORTED_MODULE_3__.m0)((()=>{"none"==forceAr.value?appTools.forceAspectRatio.value=null:appTools.forceAspectRatio.value=eval(forceAr.value)}));const isLocalMode=(0,_util__WEBPACK_IMPORTED_MODULE_0__.YU)();function localeClick(e){gameTools.locale.value=e}function jumpToPage(e){navTools.jumpToPage(e)}async function api(e,t){try{var a=await fetch(`/${APPNAME}/admin/api/`+e,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(t)});return await a.json()}catch(o){try{console.warn(o.body.error.stack.split("\n    at Object.callWith (")[0])}catch(n){console.error(o)}return}}function launchFile(e){api("launchFile",{path:"code "+e})}function gameVaultClick(){api("launchFile",{path:"xdg-open ../vault/"+gameTools.gameName.value})}function gameDefClick(){api("launchFile",{path:"code ../client/src/games/"+gameTools.gameName.value+".mjs"})}function closeDebug(){appTools.debugMode.value=!1}return(e,t)=>((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)("div",_hoisted_1,[(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("div",_hoisted_2,[(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("span",{onClick:closeDebug},"X"),t[4]||(t[4]=(0,vue__WEBPACK_IMPORTED_MODULE_3__.Uk)()),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("span",_hoisted_3,(0,vue__WEBPACK_IMPORTED_MODULE_4__.zw)((0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(gameTools).gameName.value),1)]),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("div",_hoisted_4,[(0,vue__WEBPACK_IMPORTED_MODULE_3__.WI)(e.$slots,"locales",{},(()=>[((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(!0),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)(vue__WEBPACK_IMPORTED_MODULE_3__.HY,null,(0,vue__WEBPACK_IMPORTED_MODULE_3__.Ko)((0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(gameTools).locales.value,((e,t)=>((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)("span",{key:t},[t>0?((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)(vue__WEBPACK_IMPORTED_MODULE_3__.HY,{key:0},[(0,vue__WEBPACK_IMPORTED_MODULE_3__.Uk)(" - ")],64)):(0,vue__WEBPACK_IMPORTED_MODULE_3__.kq)("",!0),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("span",{onClick:t=>(0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(gameTools).switchLocale(e),class:(0,vue__WEBPACK_IMPORTED_MODULE_4__.C_)((0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(gameTools).locale.value==e?"current-locale":"")},(0,vue__WEBPACK_IMPORTED_MODULE_4__.zw)(e),11,_hoisted_5)])))),128))]))]),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("div",_hoisted_6,[(0,vue__WEBPACK_IMPORTED_MODULE_3__.WI)(e.$slots,"pages",{},(()=>[((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(!0),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)(vue__WEBPACK_IMPORTED_MODULE_3__.HY,null,(0,vue__WEBPACK_IMPORTED_MODULE_3__.Ko)((0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(gameTools).pages.value,((e,a)=>((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)("div",{key:a,class:(0,vue__WEBPACK_IMPORTED_MODULE_4__.C_)((0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(gameTools).currentPageIndex.value==a?"current-page":"")},[(0,vue__WEBPACK_IMPORTED_MODULE_3__.Uk)((0,vue__WEBPACK_IMPORTED_MODULE_4__.zw)(a)+" - ",1),(0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(isLocalMode)?((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)("span",{key:0,style:{cursor:"pointer"},onClick:t=>launchFile(`../client/src/components/pages/${e.type}.vue`)},"⌻",8,_hoisted_7)):(0,vue__WEBPACK_IMPORTED_MODULE_3__.kq)("",!0),t[5]||(t[5]=(0,vue__WEBPACK_IMPORTED_MODULE_3__.Uk)()),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("a",{title:e.type,onClick:e=>jumpToPage(a),style:{"user-select":"all"}},(0,vue__WEBPACK_IMPORTED_MODULE_4__.zw)(e.name||e.type),9,_hoisted_8)],2)))),128))]))]),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("div",_hoisted_9,[(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("div",null,[(0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(isLocalMode)?((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)("a",_hoisted_10,"Game List")):(0,vue__WEBPACK_IMPORTED_MODULE_3__.kq)("",!0)]),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("div",null,[(0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(isLocalMode)?((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)("a",_hoisted_11,"Admin")):(0,vue__WEBPACK_IMPORTED_MODULE_3__.kq)("",!0)]),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("div",null,[(0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(isLocalMode)?((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)("div",{key:0,onClick:gameVaultClick},"⌬ vault/"+(0,vue__WEBPACK_IMPORTED_MODULE_4__.zw)((0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(gameTools).gameName.value),1)):(0,vue__WEBPACK_IMPORTED_MODULE_3__.kq)("",!0)]),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("div",null,[(0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(isLocalMode)?((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)("div",{key:0,onClick:gameDefClick},"⌻ "+(0,vue__WEBPACK_IMPORTED_MODULE_4__.zw)((0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(gameTools).gameName.value)+".mjs",1)):(0,vue__WEBPACK_IMPORTED_MODULE_3__.kq)("",!0)])]),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("div",_hoisted_12,[(0,vue__WEBPACK_IMPORTED_MODULE_3__.WI)(e.$slots,"control",{},(()=>[(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("div",null,[(0,vue__WEBPACK_IMPORTED_MODULE_3__.wy)((0,vue__WEBPACK_IMPORTED_MODULE_3__._)("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>(0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(appTools).options.auraEnabled.value=e),id:"auraEnabled"},null,512),[[vue__WEBPACK_IMPORTED_MODULE_6__.e8,(0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(appTools).options.auraEnabled.value]]),t[6]||(t[6]=(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("label",{class:"form-check-label",for:"auraEnabled"}," aura",-1))]),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("div",null,[(0,vue__WEBPACK_IMPORTED_MODULE_3__.wy)((0,vue__WEBPACK_IMPORTED_MODULE_3__._)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>(0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(appTools).options.showElements.value=e),id:"showElements"},null,512),[[vue__WEBPACK_IMPORTED_MODULE_6__.e8,(0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(appTools).options.showElements.value]]),t[7]||(t[7]=(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("label",{class:"form-check-label",for:"showElements"}," show elements",-1))]),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("div",null,[(0,vue__WEBPACK_IMPORTED_MODULE_3__.wy)((0,vue__WEBPACK_IMPORTED_MODULE_3__._)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>(0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(appTools).options.simulateSlowLoading.value=e),id:"simulateSlowLoading"},null,512),[[vue__WEBPACK_IMPORTED_MODULE_6__.e8,(0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(appTools).options.simulateSlowLoading.value]]),t[8]||(t[8]=(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("label",{class:"form-check-label",for:"simulateSlowLoading"}," simulate slow loading",-1))])]))]),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("div",_hoisted_13,[(0,vue__WEBPACK_IMPORTED_MODULE_3__.WI)(e.$slots,"scratch",{},(()=>[((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(!0),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)(vue__WEBPACK_IMPORTED_MODULE_3__.HY,null,(0,vue__WEBPACK_IMPORTED_MODULE_3__.Ko)(Object.entries((0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(gameTools).scratchPad.value),(([e,t])=>((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)("div",{key:e,style:{"user-select":"all"}},[(0,vue__WEBPACK_IMPORTED_MODULE_3__.Uk)((0,vue__WEBPACK_IMPORTED_MODULE_4__.zw)(e)+": ",1),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("i",null,(0,vue__WEBPACK_IMPORTED_MODULE_4__.zw)(t),1)])))),128)),0==Object.keys((0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(gameTools).scratchPad.value).length?((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)("div",_hoisted_14," scratchpad empty ")):(0,vue__WEBPACK_IMPORTED_MODULE_3__.kq)("",!0),0==(0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(gameTools).scoreInfo.value.score?((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)("div",_hoisted_15," no score ")):((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)("div",_hoisted_16,[(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("i",null,(0,vue__WEBPACK_IMPORTED_MODULE_4__.zw)((0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(gameTools).scoreInfo.value.leaderboardName),1),t[9]||(t[9]=(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("br",null,null,-1)),t[10]||(t[10]=(0,vue__WEBPACK_IMPORTED_MODULE_3__.Uk)(" score: ")),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("b",null,(0,vue__WEBPACK_IMPORTED_MODULE_4__.zw)((0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(gameTools).scoreInfo.value.score),1),t[11]||(t[11]=(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("br",null,null,-1)),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("span",_hoisted_17,(0,vue__WEBPACK_IMPORTED_MODULE_4__.zw)(JSON.stringify((0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(gameTools).scoreInfo.value.meta)),1)]))]))]),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("div",_hoisted_18,[(0,vue__WEBPACK_IMPORTED_MODULE_3__.WI)(e.$slots,"assets",{},(()=>[((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(!0),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)(vue__WEBPACK_IMPORTED_MODULE_3__.HY,null,(0,vue__WEBPACK_IMPORTED_MODULE_3__.Ko)((0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(gameTools).loadedImageURLs.value,(e=>((0,vue__WEBPACK_IMPORTED_MODULE_3__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_3__.iD)("a",{target:"_blank",href:e,title:e,key:e,class:"asset-thumbnail",style:(0,vue__WEBPACK_IMPORTED_MODULE_4__.j5)({"background-image":"url('"+e+"')"})},null,12,_hoisted_19)))),128))]))]),(0,vue__WEBPACK_IMPORTED_MODULE_3__._)("div",_hoisted_20,[(0,vue__WEBPACK_IMPORTED_MODULE_3__.Wm)(_Chooser2_vue__WEBPACK_IMPORTED_MODULE_1__.Z,{modelValue:(0,vue__WEBPACK_IMPORTED_MODULE_5__.SU)(forceAr),"onUpdate:modelValue":t[3]||(t[3]=e=>(0,vue__WEBPACK_IMPORTED_MODULE_5__.dq)(forceAr)?forceAr.value=e:null),options:["none","16/9","16/10","21/32","16/32"]},null,8,["modelValue"])])]))}}},794:function(e,t,a){"use strict";a.d(t,{Z:function(){return _}});var o=a(322),n=a(682);const s={class:"chooser-2"},l=["onClick"];var i=(0,o.aZ)({__name:"Chooser2",props:{modelValue:{default:{}},options:{default:["Yes","No"]}},emits:["update:modelValue"],setup(e,{emit:t}){const a=t,i=e;function r(e){a("update:modelValue",e)}const u=(0,o.Fl)((()=>i.options));return(e,t)=>((0,o.wg)(),(0,o.iD)("span",s,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(u.value,(e=>((0,o.wg)(),(0,o.iD)("span",{onClick:t=>r(e),class:(0,n.C_)(["item",{selected:e===i.modelValue}]),key:e},(0,n.zw)(e),11,l)))),128))]))}}),r=a(726),u=a.n(r),c=a(599);"function"===typeof u()&&u()(i);const d=(0,c.Z)(i,[["__scopeId","data-v-ba0ba65c"]]);var _=d},960:function(){},726:function(){}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var a=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(a.exports,a,a.exports,__webpack_require__),a.exports}__webpack_require__.m=__webpack_modules__,function(){__webpack_require__.amdO={}}(),function(){var e=[];__webpack_require__.O=function(t,a,o,n){if(!a){var s=1/0;for(u=0;u<e.length;u++){a=e[u][0],o=e[u][1],n=e[u][2];for(var l=!0,i=0;i<a.length;i++)(!1&n||s>=n)&&Object.keys(__webpack_require__.O).every((function(e){return __webpack_require__.O[e](a[i])}))?a.splice(i--,1):(l=!1,n<s&&(s=n));if(l){e.splice(u--,1);var r=o();void 0!==r&&(t=r)}}return t}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[a,o,n]}}(),function(){__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return __webpack_require__.d(t,{a:t}),t}}(),function(){__webpack_require__.d=function(e,t){for(var a in t)__webpack_require__.o(t,a)&&!__webpack_require__.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){__webpack_require__.j=826}(),function(){var e={826:0};__webpack_require__.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,n,s=a[0],l=a[1],i=a[2],r=0;if(s.some((function(t){return 0!==e[t]}))){for(o in l)__webpack_require__.o(l,o)&&(__webpack_require__.m[o]=l[o]);if(i)var u=i(__webpack_require__)}for(t&&t(a);r<s.length;r++)n=s[r],__webpack_require__.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return __webpack_require__.O(u)},a=self["webpackChunksge"]=self["webpackChunksge"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var __webpack_exports__=__webpack_require__.O(void 0,[998],(function(){return __webpack_require__(349)}));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();